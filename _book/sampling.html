<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 13 章 模拟与抽样 | 数据科学中的 R 语言</title>
  <meta name="description" content="一个简单的中文书示例。" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="第 13 章 模拟与抽样 | 数据科学中的 R 语言" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="一个简单的中文书示例。" />
  <meta name="github-repo" content="perlatex/r_for_data_science" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 13 章 模拟与抽样 | 数据科学中的 R 语言" />
  
  <meta name="twitter:description" content="一个简单的中文书示例。" />
  

<meta name="author" content="王敏杰" />


<meta name="date" content="2020-01-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tibble.html"/>
<link rel="next" href="tidystats.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable/js/pagedtable.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/str_view/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding/str_view.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\psyteachr.css" type="text/css" />
<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">数据科学中的R语言</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>前言</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-1"><i class="fa fa-check"></i>关于课程</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ryouwithme"><i class="fa fa-check"></i>RYouWithMe</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#section-2"><i class="fa fa-check"></i>致谢</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>作者简介</a></li>
<li class="part"><span><b>I 基础篇</b></span></li>
<li class="chapter" data-level="1" data-path="intro-ds.html"><a href="intro-ds.html"><i class="fa fa-check"></i><b>1</b> 数据科学与R语言</a><ul>
<li class="chapter" data-level="1.1" data-path="intro-ds.html"><a href="intro-ds.html#section-3"><i class="fa fa-check"></i><b>1.1</b> 什么是数据科学</a></li>
<li class="chapter" data-level="1.2" data-path="intro-ds.html"><a href="intro-ds.html#section-4"><i class="fa fa-check"></i><b>1.2</b> 数据科学流程</a></li>
<li class="chapter" data-level="1.3" data-path="intro-ds.html"><a href="intro-ds.html#r"><i class="fa fa-check"></i><b>1.3</b> 为什么选择 R</a></li>
<li class="chapter" data-level="1.4" data-path="intro-ds.html"><a href="intro-ds.html#r-vs-excel"><i class="fa fa-check"></i><b>1.4</b> R vs Excel</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-R.html"><a href="intro-R.html"><i class="fa fa-check"></i><b>2</b> R语言基础</a><ul>
<li class="chapter" data-level="2.1" data-path="intro-R.html"><a href="intro-R.html#r-1"><i class="fa fa-check"></i><b>2.1</b> 安装 R</a></li>
<li class="chapter" data-level="2.2" data-path="intro-R.html"><a href="intro-R.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> 安装 RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="intro-R.html"><a href="intro-R.html#section-5"><i class="fa fa-check"></i><b>2.3</b> 开始</a></li>
<li class="chapter" data-level="2.4" data-path="intro-R.html"><a href="intro-R.html#section-6"><i class="fa fa-check"></i><b>2.4</b> 对象</a></li>
<li class="chapter" data-level="2.5" data-path="intro-R.html"><a href="intro-R.html#section-7"><i class="fa fa-check"></i><b>2.5</b> 数据结构</a></li>
<li class="chapter" data-level="2.6" data-path="intro-R.html"><a href="intro-R.html#section-8"><i class="fa fa-check"></i><b>2.6</b> 函数</a></li>
<li class="chapter" data-level="2.7" data-path="intro-R.html"><a href="intro-R.html#section-9"><i class="fa fa-check"></i><b>2.7</b> 脚本</a></li>
<li class="chapter" data-level="2.8" data-path="intro-R.html"><a href="intro-R.html#section-10"><i class="fa fa-check"></i><b>2.8</b> 宏包</a></li>
<li class="chapter" data-level="2.9" data-path="intro-R.html"><a href="intro-R.html#section-11"><i class="fa fa-check"></i><b>2.9</b> 如何获取帮助</a></li>
<li class="chapter" data-level="2.10" data-path="intro-R.html"><a href="intro-R.html#r-"><i class="fa fa-check"></i><b>2.10</b> R 语言社区</a></li>
<li class="chapter" data-level="2.11" data-path="intro-R.html"><a href="intro-R.html#section-12"><i class="fa fa-check"></i><b>2.11</b> 本章代码</a></li>
<li class="chapter" data-level="2.12" data-path="intro-R.html"><a href="intro-R.html#section-13"><i class="fa fa-check"></i><b>2.12</b> 延伸阅读</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="subsetting.html"><a href="subsetting.html"><i class="fa fa-check"></i><b>3</b> 子集选取</a><ul>
<li class="chapter" data-level="3.1" data-path="subsetting.html"><a href="subsetting.html#section-14"><i class="fa fa-check"></i><b>3.1</b> 向量</a></li>
<li class="chapter" data-level="3.2" data-path="subsetting.html"><a href="subsetting.html#section-15"><i class="fa fa-check"></i><b>3.2</b> 列表</a></li>
<li class="chapter" data-level="3.3" data-path="subsetting.html"><a href="subsetting.html#section-16"><i class="fa fa-check"></i><b>3.3</b> 矩阵</a></li>
<li class="chapter" data-level="3.4" data-path="subsetting.html"><a href="subsetting.html#section-17"><i class="fa fa-check"></i><b>3.4</b> 数据框</a></li>
<li class="chapter" data-level="3.5" data-path="subsetting.html"><a href="subsetting.html#section-18"><i class="fa fa-check"></i><b>3.5</b> 增强型数据框</a></li>
<li class="chapter" data-level="3.6" data-path="subsetting.html"><a href="subsetting.html#section-19"><i class="fa fa-check"></i><b>3.6</b> 本章代码</a></li>
<li class="chapter" data-level="3.7" data-path="subsetting.html"><a href="subsetting.html#section-20"><i class="fa fa-check"></i><b>3.7</b> 延伸阅读</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visual.html"><a href="visual.html"><i class="fa fa-check"></i><b>4</b> 数据可视化</a><ul>
<li class="chapter" data-level="4.1" data-path="visual.html"><a href="visual.html#section-21"><i class="fa fa-check"></i><b>4.1</b> 为什么要可视化</a></li>
<li class="chapter" data-level="4.2" data-path="visual.html"><a href="visual.html#ggplot2-"><i class="fa fa-check"></i><b>4.2</b> ggplot2 的图形语法</a></li>
<li class="chapter" data-level="4.3" data-path="visual.html"><a href="visual.html#vs."><i class="fa fa-check"></i><b>4.3</b> 映射 vs.设置</a></li>
<li class="chapter" data-level="4.4" data-path="visual.html"><a href="visual.html#section-22"><i class="fa fa-check"></i><b>4.4</b> 几何对象</a></li>
<li class="chapter" data-level="4.5" data-path="visual.html"><a href="visual.html#global-vs.-local"><i class="fa fa-check"></i><b>4.5</b> Global vs. Local</a></li>
<li class="chapter" data-level="4.6" data-path="visual.html"><a href="visual.html#saving-plots"><i class="fa fa-check"></i><b>4.6</b> saving plots</a></li>
<li class="chapter" data-level="4.7" data-path="visual.html"><a href="visual.html#section-23"><i class="fa fa-check"></i><b>4.7</b> 本章代码</a></li>
<li class="chapter" data-level="4.8" data-path="visual.html"><a href="visual.html#section-24"><i class="fa fa-check"></i><b>4.8</b> 延伸阅读</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="rmarkdown.html"><a href="rmarkdown.html"><i class="fa fa-check"></i><b>5</b> 可重复性研究</a><ul>
<li class="chapter" data-level="5.1" data-path="rmarkdown.html"><a href="rmarkdown.html#communicating-with-data-via-r-markdown"><i class="fa fa-check"></i><b>5.1</b> Communicating with Data via R Markdown</a></li>
<li class="chapter" data-level="5.2" data-path="rmarkdown.html"><a href="rmarkdown.html#markdown-"><i class="fa fa-check"></i><b>5.2</b> markdown 基本语法</a></li>
<li class="chapter" data-level="5.3" data-path="rmarkdown.html"><a href="rmarkdown.html#hello-r-markdown"><i class="fa fa-check"></i><b>5.3</b> Hello R Markdown</a><ul>
<li class="chapter" data-level="5.3.1" data-path="rmarkdown.html"><a href="rmarkdown.html#section-25"><i class="fa fa-check"></i><b>5.3.1</b> 插入公式</a></li>
<li class="chapter" data-level="5.3.2" data-path="rmarkdown.html"><a href="rmarkdown.html#section-26"><i class="fa fa-check"></i><b>5.3.2</b> 插入图片</a></li>
<li class="chapter" data-level="5.3.3" data-path="rmarkdown.html"><a href="rmarkdown.html#section-27"><i class="fa fa-check"></i><b>5.3.3</b> 表格</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="rmarkdown.html"><a href="rmarkdown.html#html_document"><i class="fa fa-check"></i><b>5.4</b> html_document</a></li>
<li class="chapter" data-level="5.5" data-path="rmarkdown.html"><a href="rmarkdown.html#pdf_document"><i class="fa fa-check"></i><b>5.5</b> pdf_document</a></li>
<li class="chapter" data-level="5.6" data-path="rmarkdown.html"><a href="rmarkdown.html#section-28"><i class="fa fa-check"></i><b>5.6</b> 本章代码</a></li>
<li class="chapter" data-level="5.7" data-path="rmarkdown.html"><a href="rmarkdown.html#section-29"><i class="fa fa-check"></i><b>5.7</b> 延伸阅读</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> 数据处理</a><ul>
<li class="chapter" data-level="6.1" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>6.1</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="6.2" data-path="dplyr.html"><a href="dplyr.html#section-30"><i class="fa fa-check"></i><b>6.2</b> <code>管道</code> %&gt;%</a></li>
<li class="chapter" data-level="6.3" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>6.3</b> <code>select()</code></a></li>
<li class="chapter" data-level="6.4" data-path="dplyr.html"><a href="dplyr.html#filter"><i class="fa fa-check"></i><b>6.4</b> <code>filter()</code></a></li>
<li class="chapter" data-level="6.5" data-path="dplyr.html"><a href="dplyr.html#summarise"><i class="fa fa-check"></i><b>6.5</b> <code>summarise()</code>统计</a></li>
<li class="chapter" data-level="6.6" data-path="dplyr.html"><a href="dplyr.html#group_by"><i class="fa fa-check"></i><b>6.6</b> <code>group_by()</code>分组</a></li>
<li class="chapter" data-level="6.7" data-path="dplyr.html"><a href="dplyr.html#arrange"><i class="fa fa-check"></i><b>6.7</b> <code>arrange()</code>排序</a></li>
<li class="chapter" data-level="6.8" data-path="dplyr.html"><a href="dplyr.html#left_join"><i class="fa fa-check"></i><b>6.8</b> <code>left_join</code></a></li>
<li class="chapter" data-level="6.9" data-path="dplyr.html"><a href="dplyr.html#section-31"><i class="fa fa-check"></i><b>6.9</b> 延伸阅读</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="stringr.html"><a href="stringr.html"><i class="fa fa-check"></i><b>7</b> 正则表达式</a><ul>
<li class="chapter" data-level="7.1" data-path="stringr.html"><a href="stringr.html#section-32"><i class="fa fa-check"></i><b>7.1</b> 什么是正则表达式</a></li>
<li class="chapter" data-level="7.2" data-path="stringr.html"><a href="stringr.html#section-33"><i class="fa fa-check"></i><b>7.2</b> 字符串基础</a><ul>
<li class="chapter" data-level="7.2.1" data-path="stringr.html"><a href="stringr.html#section-34"><i class="fa fa-check"></i><b>7.2.1</b> 字符串长度</a></li>
<li class="chapter" data-level="7.2.2" data-path="stringr.html"><a href="stringr.html#section-35"><i class="fa fa-check"></i><b>7.2.2</b> 字符串组合</a></li>
<li class="chapter" data-level="7.2.3" data-path="stringr.html"><a href="stringr.html#section-36"><i class="fa fa-check"></i><b>7.2.3</b> 字符串取子集</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="stringr.html"><a href="stringr.html#section-37"><i class="fa fa-check"></i><b>7.3</b> 使用正则表达式进行模式匹配</a><ul>
<li class="chapter" data-level="7.3.1" data-path="stringr.html"><a href="stringr.html#section-38"><i class="fa fa-check"></i><b>7.3.1</b> 基础匹配</a></li>
<li class="chapter" data-level="7.3.2" data-path="stringr.html"><a href="stringr.html#section-39"><i class="fa fa-check"></i><b>7.3.2</b> 锚点</a></li>
<li class="chapter" data-level="7.3.3" data-path="stringr.html"><a href="stringr.html#section-40"><i class="fa fa-check"></i><b>7.3.3</b> 字符类与字符选项</a></li>
<li class="chapter" data-level="7.3.4" data-path="stringr.html"><a href="stringr.html#section-41"><i class="fa fa-check"></i><b>7.3.4</b> 重复</a></li>
<li class="chapter" data-level="7.3.5" data-path="stringr.html"><a href="stringr.html#section-42"><i class="fa fa-check"></i><b>7.3.5</b> 分组与回溯引用</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="stringr.html"><a href="stringr.html#section-43"><i class="fa fa-check"></i><b>7.4</b> 解决实际问题</a><ul>
<li class="chapter" data-level="7.4.1" data-path="stringr.html"><a href="stringr.html#section-44"><i class="fa fa-check"></i><b>7.4.1</b> 确定一个字符向量是否匹配一种模式</a></li>
<li class="chapter" data-level="7.4.2" data-path="stringr.html"><a href="stringr.html#section-45"><i class="fa fa-check"></i><b>7.4.2</b> 确定匹配的位置</a></li>
<li class="chapter" data-level="7.4.3" data-path="stringr.html"><a href="stringr.html#section-46"><i class="fa fa-check"></i><b>7.4.3</b> 提取匹配的内容</a></li>
<li class="chapter" data-level="7.4.4" data-path="stringr.html"><a href="stringr.html#section-47"><i class="fa fa-check"></i><b>7.4.4</b> 替换匹配内容</a></li>
<li class="chapter" data-level="7.4.5" data-path="stringr.html"><a href="stringr.html#section-48"><i class="fa fa-check"></i><b>7.4.5</b> 拆分字符串</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="stringr.html"><a href="stringr.html#section-49"><i class="fa fa-check"></i><b>7.5</b> 进阶部分</a><ul>
<li class="chapter" data-level="7.5.1" data-path="stringr.html"><a href="stringr.html#look-ahead"><i class="fa fa-check"></i><b>7.5.1</b> look ahead</a></li>
<li class="chapter" data-level="7.5.2" data-path="stringr.html"><a href="stringr.html#look-behind"><i class="fa fa-check"></i><b>7.5.2</b> look behind</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="stringr.html"><a href="stringr.html#section-50"><i class="fa fa-check"></i><b>7.6</b> 案例分析</a><ul>
<li class="chapter" data-level="7.6.1" data-path="stringr.html"><a href="stringr.html#section-51"><i class="fa fa-check"></i><b>7.6.1</b> 案例1</a></li>
<li class="chapter" data-level="7.6.2" data-path="stringr.html"><a href="stringr.html#section-52"><i class="fa fa-check"></i><b>7.6.2</b> 案例2</a></li>
<li class="chapter" data-level="7.6.3" data-path="stringr.html"><a href="stringr.html#section-53"><i class="fa fa-check"></i><b>7.6.3</b> 案例3</a></li>
<li class="chapter" data-level="7.6.4" data-path="stringr.html"><a href="stringr.html#section-54"><i class="fa fa-check"></i><b>7.6.4</b> 案例4</a></li>
<li class="chapter" data-level="7.6.5" data-path="stringr.html"><a href="stringr.html#section-55"><i class="fa fa-check"></i><b>7.6.5</b> 案例5</a></li>
<li class="chapter" data-level="7.6.6" data-path="stringr.html"><a href="stringr.html#section-56"><i class="fa fa-check"></i><b>7.6.6</b> 案例6</a></li>
<li class="chapter" data-level="7.6.7" data-path="stringr.html"><a href="stringr.html#section-57"><i class="fa fa-check"></i><b>7.6.7</b> 案例7</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="stringr.html"><a href="stringr.html#section-58"><i class="fa fa-check"></i><b>7.7</b> 一些有趣的正则表达式的宏包</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="purrr.html"><a href="purrr.html"><i class="fa fa-check"></i><b>8</b> 函数式编程</a><ul>
<li class="chapter" data-level="8.1" data-path="purrr.html"><a href="purrr.html#section-59"><i class="fa fa-check"></i><b>8.1</b> 简单回顾</a></li>
<li class="chapter" data-level="8.2" data-path="purrr.html"><a href="purrr.html#section-60"><i class="fa fa-check"></i><b>8.2</b> 多说说列表</a></li>
<li class="chapter" data-level="8.3" data-path="purrr.html"><a href="purrr.html#vs-"><i class="fa fa-check"></i><b>8.3</b> 列表 vs 向量</a></li>
<li class="chapter" data-level="8.4" data-path="purrr.html"><a href="purrr.html#purrr-1"><i class="fa fa-check"></i><b>8.4</b> purrr</a></li>
<li class="chapter" data-level="8.5" data-path="purrr.html"><a href="purrr.html#section-61"><i class="fa fa-check"></i><b>8.5</b> 自定义函数</a></li>
<li class="chapter" data-level="8.6" data-path="purrr.html"><a href="purrr.html#section-62"><i class="fa fa-check"></i><b>8.6</b> 延伸阅读</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>9</b> 探索性数据分析</a><ul>
<li class="chapter" data-level="9.1" data-path="eda.html"><a href="eda.html#section-63"><i class="fa fa-check"></i><b>9.1</b> 探索性</a></li>
<li class="chapter" data-level="9.2" data-path="eda.html"><a href="eda.html#section-64"><i class="fa fa-check"></i><b>9.2</b> 数据集</a></li>
<li class="chapter" data-level="9.3" data-path="eda.html"><a href="eda.html#section-65"><i class="fa fa-check"></i><b>9.3</b> 导入数据</a></li>
<li class="chapter" data-level="9.4" data-path="eda.html"><a href="eda.html#section-66"><i class="fa fa-check"></i><b>9.4</b> 数据结构</a></li>
<li class="chapter" data-level="9.5" data-path="eda.html"><a href="eda.html#section-67"><i class="fa fa-check"></i><b>9.5</b> 我们想探索哪些问题？</a></li>
<li class="chapter" data-level="9.6" data-path="eda.html"><a href="eda.html#section-68"><i class="fa fa-check"></i><b>9.6</b> 每个学科颁过多少次奖</a></li>
<li class="chapter" data-level="9.7" data-path="eda.html"><a href="eda.html#section-69"><i class="fa fa-check"></i><b>9.7</b> 看看我们伟大的祖国</a></li>
<li class="chapter" data-level="9.8" data-path="eda.html"><a href="eda.html#section-70"><i class="fa fa-check"></i><b>9.8</b> 哪些大神多次获得诺贝尔奖</a></li>
<li class="chapter" data-level="9.9" data-path="eda.html"><a href="eda.html#section-71"><i class="fa fa-check"></i><b>9.9</b> 大神在得奖的时候是多大年龄？</a></li>
<li class="chapter" data-level="9.10" data-path="eda.html"><a href="eda.html#section-72"><i class="fa fa-check"></i><b>9.10</b> 性别比例</a></li>
<li class="chapter" data-level="9.11" data-path="eda.html"><a href="eda.html#section-73"><i class="fa fa-check"></i><b>9.11</b> 这些大神都是哪个年代出生的人？</a></li>
<li class="chapter" data-level="9.12" data-path="eda.html"><a href="eda.html#section-74"><i class="fa fa-check"></i><b>9.12</b> 最年轻的诺奖获得者？</a></li>
<li class="chapter" data-level="9.13" data-path="eda.html"><a href="eda.html#section-75"><i class="fa fa-check"></i><b>9.13</b> 平均年龄和获奖数量</a></li>
<li class="chapter" data-level="9.14" data-path="eda.html"><a href="eda.html#section-76"><i class="fa fa-check"></i><b>9.14</b> 出生地与工作地分布</a></li>
<li class="chapter" data-level="9.15" data-path="eda.html"><a href="eda.html#section-77"><i class="fa fa-check"></i><b>9.15</b> 迁移模式</a></li>
<li class="chapter" data-level="9.16" data-path="eda.html"><a href="eda.html#section-78"><i class="fa fa-check"></i><b>9.16</b> 地图</a></li>
<li class="chapter" data-level="9.17" data-path="eda.html"><a href="eda.html#section-79"><i class="fa fa-check"></i><b>9.17</b> 出生地和工作地不一样的占比</a></li>
<li class="chapter" data-level="9.18" data-path="eda.html"><a href="eda.html#section-80"><i class="fa fa-check"></i><b>9.18</b> 诺奖分享者</a></li>
<li class="chapter" data-level="9.19" data-path="eda.html"><a href="eda.html#section-81"><i class="fa fa-check"></i><b>9.19</b> 其它</a></li>
<li class="chapter" data-level="9.20" data-path="eda.html"><a href="eda.html#section-82"><i class="fa fa-check"></i><b>9.20</b> 延伸阅读</a></li>
</ul></li>
<li class="part"><span><b>II tidyverse篇</b></span></li>
<li class="chapter" data-level="10" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>10</b> ggplot2</a><ul>
<li class="chapter" data-level="10.1" data-path="ggplot2.html"><a href="ggplot2.html#section-83"><i class="fa fa-check"></i><b>10.1</b> 一个有趣的案例</a></li>
<li class="chapter" data-level="10.2" data-path="ggplot2.html"><a href="ggplot2.html#section-84"><i class="fa fa-check"></i><b>10.2</b> 学习目标</a></li>
<li class="chapter" data-level="10.3" data-path="ggplot2.html"><a href="ggplot2.html#section-85"><i class="fa fa-check"></i><b>10.3</b> 开始</a><ul>
<li class="chapter" data-level="10.3.1" data-path="ggplot2.html"><a href="ggplot2.html#section-86"><i class="fa fa-check"></i><b>10.3.1</b> 导入数据</a></li>
<li class="chapter" data-level="10.3.2" data-path="ggplot2.html"><a href="ggplot2.html#section-87"><i class="fa fa-check"></i><b>10.3.2</b> 检查数据</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="ggplot2.html"><a href="ggplot2.html#section-88"><i class="fa fa-check"></i><b>10.4</b> 基本绘图</a><ul>
<li class="chapter" data-level="10.4.1" data-path="ggplot2.html"><a href="ggplot2.html#section-89"><i class="fa fa-check"></i><b>10.4.1</b> 柱状图</a></li>
<li class="chapter" data-level="10.4.2" data-path="ggplot2.html"><a href="ggplot2.html#section-90"><i class="fa fa-check"></i><b>10.4.2</b> 直方图</a></li>
<li class="chapter" data-level="10.4.3" data-path="ggplot2.html"><a href="ggplot2.html#section-91"><i class="fa fa-check"></i><b>10.4.3</b> 箱线图</a></li>
<li class="chapter" data-level="10.4.4" data-path="ggplot2.html"><a href="ggplot2.html#section-92"><i class="fa fa-check"></i><b>10.4.4</b> 抖散图</a></li>
<li class="chapter" data-level="10.4.5" data-path="ggplot2.html"><a href="ggplot2.html#section-93"><i class="fa fa-check"></i><b>10.4.5</b> 山峦图</a></li>
<li class="chapter" data-level="10.4.6" data-path="ggplot2.html"><a href="ggplot2.html#section-94"><i class="fa fa-check"></i><b>10.4.6</b> 散点图</a></li>
<li class="chapter" data-level="10.4.7" data-path="ggplot2.html"><a href="ggplot2.html#section-95"><i class="fa fa-check"></i><b>10.4.7</b> 点线图</a></li>
<li class="chapter" data-level="10.4.8" data-path="ggplot2.html"><a href="ggplot2.html#section-96"><i class="fa fa-check"></i><b>10.4.8</b> 文本标注</a></li>
<li class="chapter" data-level="10.4.9" data-path="ggplot2.html"><a href="ggplot2.html#errorbar"><i class="fa fa-check"></i><b>10.4.9</b> errorbar图</a></li>
<li class="chapter" data-level="10.4.10" data-path="ggplot2.html"><a href="ggplot2.html#section-97"><i class="fa fa-check"></i><b>10.4.10</b> 椭圆图</a></li>
<li class="chapter" data-level="10.4.11" data-path="ggplot2.html"><a href="ggplot2.html#d-"><i class="fa fa-check"></i><b>10.4.11</b> 2D 密度图</a></li>
<li class="chapter" data-level="10.4.12" data-path="ggplot2.html"><a href="ggplot2.html#section-98"><i class="fa fa-check"></i><b>10.4.12</b> 马赛克图</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="ggplot2.html"><a href="ggplot2.html#section-99"><i class="fa fa-check"></i><b>10.5</b> 主题风格</a></li>
<li class="chapter" data-level="10.6" data-path="ggplot2.html"><a href="ggplot2.html#section-100"><i class="fa fa-check"></i><b>10.6</b> 定制</a><ul>
<li class="chapter" data-level="10.6.1" data-path="ggplot2.html"><a href="ggplot2.html#labels"><i class="fa fa-check"></i><b>10.6.1</b> Labels</a></li>
<li class="chapter" data-level="10.6.2" data-path="ggplot2.html"><a href="ggplot2.html#section-101"><i class="fa fa-check"></i><b>10.6.2</b> 定制颜色</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="ggplot2.html"><a href="ggplot2.html#section-102"><i class="fa fa-check"></i><b>10.7</b> 组合图片</a><ul>
<li class="chapter" data-level="10.7.1" data-path="ggplot2.html"><a href="ggplot2.html#cowplot"><i class="fa fa-check"></i><b>10.7.1</b> cowplot</a></li>
<li class="chapter" data-level="10.7.2" data-path="ggplot2.html"><a href="ggplot2.html#section-103"><i class="fa fa-check"></i><b>10.7.2</b> 保存图片</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="ggplot2.html"><a href="ggplot2.html#section-104"><i class="fa fa-check"></i><b>10.8</b> 中文字体</a></li>
<li class="chapter" data-level="10.9" data-path="ggplot2.html"><a href="ggplot2.html#section-105"><i class="fa fa-check"></i><b>10.9</b> 高亮某一组</a><ul>
<li class="chapter" data-level="10.9.1" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-1"><i class="fa fa-check"></i><b>10.9.1</b> ggplot2方法</a></li>
<li class="chapter" data-level="10.9.2" data-path="ggplot2.html"><a href="ggplot2.html#gghighlight"><i class="fa fa-check"></i><b>10.9.2</b> gghighlight方法</a></li>
</ul></li>
<li class="chapter" data-level="10.10" data-path="ggplot2.html"><a href="ggplot2.html#section-106"><i class="fa fa-check"></i><b>10.10</b> 函数图</a></li>
<li class="chapter" data-level="10.11" data-path="ggplot2.html"><a href="ggplot2.html#section-107"><i class="fa fa-check"></i><b>10.11</b> 地图</a><ul>
<li class="chapter" data-level="10.11.1" data-path="ggplot2.html"><a href="ggplot2.html#latex"><i class="fa fa-check"></i><b>10.11.1</b> latex公式</a></li>
</ul></li>
<li class="chapter" data-level="10.12" data-path="ggplot2.html"><a href="ggplot2.html#section-108"><i class="fa fa-check"></i><b>10.12</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="tips.html"><a href="tips.html"><i class="fa fa-check"></i><b>11</b> tidyverse中的若干技巧</a><ul>
<li class="chapter" data-level="11.1" data-path="tips.html"><a href="tips.html#from-gather-to-pivot"><i class="fa fa-check"></i><b>11.1</b> From <code>gather()</code> to <code>pivot()</code></a></li>
<li class="chapter" data-level="11.2" data-path="tips.html"><a href="tips.html#count"><i class="fa fa-check"></i><b>11.2</b> count()</a></li>
<li class="chapter" data-level="11.3" data-path="tips.html"><a href="tips.html#count-"><i class="fa fa-check"></i><b>11.3</b> 在 count() 中创建新变量</a></li>
<li class="chapter" data-level="11.4" data-path="tips.html"><a href="tips.html#add_count"><i class="fa fa-check"></i><b>11.4</b> add_count()</a></li>
<li class="chapter" data-level="11.5" data-path="tips.html"><a href="tips.html#nth-first-last"><i class="fa fa-check"></i><b>11.5</b> nth(), first(), last()</a></li>
<li class="chapter" data-level="11.6" data-path="tips.html"><a href="tips.html#section-109"><i class="fa fa-check"></i><b>11.6</b> 列变量重新排序</a></li>
<li class="chapter" data-level="11.7" data-path="tips.html"><a href="tips.html#if_else"><i class="fa fa-check"></i><b>11.7</b> if_else</a></li>
<li class="chapter" data-level="11.8" data-path="tips.html"><a href="tips.html#case_when"><i class="fa fa-check"></i><b>11.8</b> case_when</a></li>
<li class="chapter" data-level="11.9" data-path="tips.html"><a href="tips.html#section-110"><i class="fa fa-check"></i><b>11.9</b> 找出前几名</a></li>
<li class="chapter" data-level="11.10" data-path="tips.html"><a href="tips.html#drop_na"><i class="fa fa-check"></i><b>11.10</b> drop_na()</a></li>
<li class="chapter" data-level="11.11" data-path="tips.html"><a href="tips.html#replace_na"><i class="fa fa-check"></i><b>11.11</b> replace_na()</a></li>
<li class="chapter" data-level="11.12" data-path="tips.html"><a href="tips.html#coalesce"><i class="fa fa-check"></i><b>11.12</b> coalesce</a></li>
<li class="chapter" data-level="11.13" data-path="tips.html"><a href="tips.html#summarise--list-column"><i class="fa fa-check"></i><b>11.13</b> summarise() 生成 list-column</a></li>
<li class="chapter" data-level="11.14" data-path="tips.html"><a href="tips.html#count-fct_reorder-geom_col-coord_flip"><i class="fa fa-check"></i><b>11.14</b> count() + fct_reorder() + geom_col() + coord_flip()</a></li>
<li class="chapter" data-level="11.15" data-path="tips.html"><a href="tips.html#scale_xy_log10"><i class="fa fa-check"></i><b>11.15</b> scale_x/y_log10</a></li>
<li class="chapter" data-level="11.16" data-path="tips.html"><a href="tips.html#fct_lump"><i class="fa fa-check"></i><b>11.16</b> fct_lump</a></li>
<li class="chapter" data-level="11.17" data-path="tips.html"><a href="tips.html#unite"><i class="fa fa-check"></i><b>11.17</b> unite</a></li>
<li class="chapter" data-level="11.18" data-path="tips.html"><a href="tips.html#separate"><i class="fa fa-check"></i><b>11.18</b> separate()</a></li>
<li class="chapter" data-level="11.19" data-path="tips.html"><a href="tips.html#extract"><i class="fa fa-check"></i><b>11.19</b> extract()</a></li>
<li class="chapter" data-level="11.20" data-path="tips.html"><a href="tips.html#crossing"><i class="fa fa-check"></i><b>11.20</b> crossing()</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="tibble.html"><a href="tibble.html"><i class="fa fa-check"></i><b>12</b> 简单数据框</a><ul>
<li class="chapter" data-level="12.1" data-path="tibble.html"><a href="tibble.html#tidyverse-"><i class="fa fa-check"></i><b>12.1</b> tidyverse 家族</a></li>
<li class="chapter" data-level="12.2" data-path="tibble.html"><a href="tibble.html#tibble-1"><i class="fa fa-check"></i><b>12.2</b> 人性化的tibble</a></li>
<li class="chapter" data-level="12.3" data-path="tibble.html"><a href="tibble.html#tibble--data.frame"><i class="fa fa-check"></i><b>12.3</b> tibble 与 data.frame</a></li>
<li class="chapter" data-level="12.4" data-path="tibble.html"><a href="tibble.html#tibble-2"><i class="fa fa-check"></i><b>12.4</b> tibble数据操作</a><ul>
<li class="chapter" data-level="12.4.1" data-path="tibble.html"><a href="tibble.html#tibble-3"><i class="fa fa-check"></i><b>12.4.1</b> 创建tibble</a></li>
<li class="chapter" data-level="12.4.2" data-path="tibble.html"><a href="tibble.html#tibble-4"><i class="fa fa-check"></i><b>12.4.2</b> 转换成tibble类型</a></li>
<li class="chapter" data-level="12.4.3" data-path="tibble.html"><a href="tibble.html#tibble-5"><i class="fa fa-check"></i><b>12.4.3</b> tibble简单操作</a></li>
<li class="chapter" data-level="12.4.4" data-path="tibble.html"><a href="tibble.html#lst"><i class="fa fa-check"></i><b>12.4.4</b> 有用的函数<code>lst</code></a></li>
<li class="chapter" data-level="12.4.5" data-path="tibble.html"><a href="tibble.html#enframe"><i class="fa fa-check"></i><b>12.4.5</b> 有用的函数<code>enframe</code></a></li>
<li class="chapter" data-level="12.4.6" data-path="tibble.html"><a href="tibble.html#deframe"><i class="fa fa-check"></i><b>12.4.6</b> 有用的函数<code>deframe</code></a></li>
<li class="chapter" data-level="12.4.7" data-path="tibble.html"><a href="tibble.html#section-111"><i class="fa fa-check"></i><b>12.4.7</b> 读取文件</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="tibble.html"><a href="tibble.html#section-112"><i class="fa fa-check"></i><b>12.5</b> 关于行名</a></li>
<li class="chapter" data-level="12.6" data-path="tibble.html"><a href="tibble.html#section-113"><i class="fa fa-check"></i><b>12.6</b> 修复列名</a></li>
<li class="chapter" data-level="12.7" data-path="tibble.html"><a href="tibble.html#nested-tibble"><i class="fa fa-check"></i><b>12.7</b> nested tibble</a></li>
<li class="chapter" data-level="12.8" data-path="tibble.html"><a href="tibble.html#section-114"><i class="fa fa-check"></i><b>12.8</b> 延伸阅读</a></li>
</ul></li>
<li class="part"><span><b>III 建模篇</b></span></li>
<li class="chapter" data-level="13" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>13</b> 模拟与抽样</a><ul>
<li class="chapter" data-level="13.1" data-path="sampling.html"><a href="sampling.html#section-115"><i class="fa fa-check"></i><b>13.1</b> 模拟</a><ul>
<li class="chapter" data-level="13.1.1" data-path="sampling.html"><a href="sampling.html#section-116"><i class="fa fa-check"></i><b>13.1.1</b> 生成随机数</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="sampling.html"><a href="sampling.html#massmvrnorm"><i class="fa fa-check"></i><b>13.2</b> MASS::mvrnorm</a></li>
<li class="chapter" data-level="13.3" data-path="sampling.html"><a href="sampling.html#section-117"><i class="fa fa-check"></i><b>13.3</b> 蒙特卡洛</a></li>
<li class="chapter" data-level="13.4" data-path="sampling.html"><a href="sampling.html#section-118"><i class="fa fa-check"></i><b>13.4</b> 抽样与样本</a><ul>
<li class="chapter" data-level="13.4.1" data-path="sampling.html"><a href="sampling.html#section-119"><i class="fa fa-check"></i><b>13.4.1</b> 总体分布</a></li>
<li class="chapter" data-level="13.4.2" data-path="sampling.html"><a href="sampling.html#section-120"><i class="fa fa-check"></i><b>13.4.2</b> 样本</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="sampling.html"><a href="sampling.html#section-121"><i class="fa fa-check"></i><b>13.5</b> 扩展阅读</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="tidystats.html"><a href="tidystats.html"><i class="fa fa-check"></i><b>14</b> Tidy Statistics</a><ul>
<li class="chapter" data-level="14.1" data-path="tidystats.html"><a href="tidystats.html#section-122"><i class="fa fa-check"></i><b>14.1</b> 从一个案例开始</a></li>
<li class="chapter" data-level="14.2" data-path="tidystats.html"><a href="tidystats.html#section-123"><i class="fa fa-check"></i><b>14.2</b> 单因素方差分析</a></li>
<li class="chapter" data-level="14.3" data-path="tidystats.html"><a href="tidystats.html#section-124"><i class="fa fa-check"></i><b>14.3</b> 双因素方差分析</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>15</b> 线性回归</a><ul>
<li class="chapter" data-level="15.1" data-path="lm.html"><a href="lm.html#section-125"><i class="fa fa-check"></i><b>15.1</b> 从一个案例开始</a><ul>
<li class="chapter" data-level="15.1.1" data-path="lm.html"><a href="lm.html#section-126"><i class="fa fa-check"></i><b>15.1.1</b> 缺失值检查</a></li>
<li class="chapter" data-level="15.1.2" data-path="lm.html"><a href="lm.html#section-127"><i class="fa fa-check"></i><b>15.1.2</b> 变量简单统计</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="lm.html"><a href="lm.html#section-128"><i class="fa fa-check"></i><b>15.2</b> 线性回归模型</a></li>
<li class="chapter" data-level="15.3" data-path="lm.html"><a href="lm.html#lm-"><i class="fa fa-check"></i><b>15.3</b> 使用<code>lm()</code> 函数</a></li>
<li class="chapter" data-level="15.4" data-path="lm.html"><a href="lm.html#section-129"><i class="fa fa-check"></i><b>15.4</b> 模型的解释</a></li>
<li class="chapter" data-level="15.5" data-path="lm.html"><a href="lm.html#section-130"><i class="fa fa-check"></i><b>15.5</b> 多元线性回归</a></li>
<li class="chapter" data-level="15.6" data-path="lm.html"><a href="lm.html#section-131"><i class="fa fa-check"></i><b>15.6</b> 更多模型</a></li>
<li class="chapter" data-level="15.7" data-path="lm.html"><a href="lm.html#section-132"><i class="fa fa-check"></i><b>15.7</b> 可能遇到的情形</a><ul>
<li class="chapter" data-level="15.7.1" data-path="lm.html"><a href="lm.html#section-133"><i class="fa fa-check"></i><b>15.7.1</b> 截距项</a></li>
<li class="chapter" data-level="15.7.2" data-path="lm.html"><a href="lm.html#section-134"><i class="fa fa-check"></i><b>15.7.2</b> 只有截距</a></li>
<li class="chapter" data-level="15.7.3" data-path="lm.html"><a href="lm.html#section-135"><i class="fa fa-check"></i><b>15.7.3</b> 分类变量</a></li>
<li class="chapter" data-level="15.7.4" data-path="lm.html"><a href="lm.html#section-136"><i class="fa fa-check"></i><b>15.7.4</b> 因子变量</a></li>
<li class="chapter" data-level="15.7.5" data-path="lm.html"><a href="lm.html#section-137"><i class="fa fa-check"></i><b>15.7.5</b> 一个分类变量和一个连续变量</a></li>
<li class="chapter" data-level="15.7.6" data-path="lm.html"><a href="lm.html#section-138"><i class="fa fa-check"></i><b>15.7.6</b> 偷懒的写法</a></li>
<li class="chapter" data-level="15.7.7" data-path="lm.html"><a href="lm.html#section-139"><i class="fa fa-check"></i><b>15.7.7</b> 交互项</a></li>
<li class="chapter" data-level="15.7.8" data-path="lm.html"><a href="lm.html#predict-vs-fit"><i class="fa fa-check"></i><b>15.7.8</b> predict vs fit</a></li>
<li class="chapter" data-level="15.7.9" data-path="lm.html"><a href="lm.html#section-140"><i class="fa fa-check"></i><b>15.7.9</b> 回归和相关的关系</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="lm.html"><a href="lm.html#section-141"><i class="fa fa-check"></i><b>15.8</b> 延伸阅读</a></li>
</ul></li>
<li class="part"><span><b>IV 应用篇</b></span></li>
<li class="chapter" data-level="16" data-path="advR.html"><a href="advR.html"><i class="fa fa-check"></i><b>16</b> tidyverse进阶</a><ul>
<li class="chapter" data-level="16.1" data-path="advR.html"><a href="advR.html#scoped-"><i class="fa fa-check"></i><b>16.1</b> scoped 函数</a><ul>
<li class="chapter" data-level="16.1.1" data-path="advR.html"><a href="advR.html#mutate_if"><i class="fa fa-check"></i><b>16.1.1</b> mutate_if</a></li>
<li class="chapter" data-level="16.1.2" data-path="advR.html"><a href="advR.html#select_if"><i class="fa fa-check"></i><b>16.1.2</b> select_if()</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="advR.html"><a href="advR.html#summarise_if"><i class="fa fa-check"></i><b>16.2</b> summarise_if</a></li>
<li class="chapter" data-level="16.3" data-path="advR.html"><a href="advR.html#filter_if"><i class="fa fa-check"></i><b>16.3</b> filter_if()</a></li>
<li class="chapter" data-level="16.4" data-path="advR.html"><a href="advR.html#group_by-1"><i class="fa fa-check"></i><b>16.4</b> group_by</a><ul>
<li class="chapter" data-level="16.4.1" data-path="advR.html"><a href="advR.html#group_split-group_map-group_modify"><i class="fa fa-check"></i><b>16.4.1</b> group_split(), group_map(), group_modify()</a></li>
<li class="chapter" data-level="16.4.2" data-path="advR.html"><a href="advR.html#group"><i class="fa fa-check"></i><b>16.4.2</b> 其他group函数</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="advR.html"><a href="advR.html#section-142"><i class="fa fa-check"></i><b>16.5</b> 列名清理</a></li>
<li class="chapter" data-level="16.6" data-path="advR.html"><a href="advR.html#section-143"><i class="fa fa-check"></i><b>16.6</b> 缺失值检查与处理</a><ul>
<li class="chapter" data-level="16.6.1" data-path="advR.html"><a href="advR.html#purrr-dplyr-"><i class="fa fa-check"></i><b>16.6.1</b> purrr &amp; dplyr 技巧</a></li>
<li class="chapter" data-level="16.6.2" data-path="advR.html"><a href="advR.html#section-144"><i class="fa fa-check"></i><b>16.6.2</b> 缺失值替换</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="advR.html"><a href="advR.html#section-145"><i class="fa fa-check"></i><b>16.7</b> 标准化</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="rowwise.html"><a href="rowwise.html"><i class="fa fa-check"></i><b>17</b> tidyverse中行方向的操作</a><ul>
<li class="chapter" data-level="17.1" data-path="rowwise.html"><a href="rowwise.html#section-146"><i class="fa fa-check"></i><b>17.1</b> 问题</a></li>
<li class="chapter" data-level="17.2" data-path="rowwise.html"><a href="rowwise.html#rowwise-1"><i class="fa fa-check"></i><b>17.2</b> rowwise函数</a></li>
<li class="chapter" data-level="17.3" data-path="rowwise.html"><a href="rowwise.html#row-wise-summaries"><i class="fa fa-check"></i><b>17.3</b> Row-wise Summaries</a></li>
<li class="chapter" data-level="17.4" data-path="rowwise.html"><a href="rowwise.html#purrrmap"><i class="fa fa-check"></i><b>17.4</b> purrr::map方案</a></li>
<li class="chapter" data-level="17.5" data-path="rowwise.html"><a href="rowwise.html#tidy-"><i class="fa fa-check"></i><b>17.5</b> tidy 的方案</a></li>
<li class="chapter" data-level="17.6" data-path="rowwise.html"><a href="rowwise.html#slide"><i class="fa fa-check"></i><b>17.6</b> slide方案</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="dot.html"><a href="dot.html"><i class="fa fa-check"></i><b>18</b> tidyverse中的dot</a><ul>
<li class="chapter" data-level="18.1" data-path="dot.html"><a href="dot.html#section-147"><i class="fa fa-check"></i><b>18.1</b> 每一行的 <code>.</code> 各自代表什么意思呢?</a></li>
<li class="chapter" data-level="18.2" data-path="dot.html"><a href="dot.html#section-148"><i class="fa fa-check"></i><b>18.2</b> 占位符</a></li>
<li class="chapter" data-level="18.3" data-path="dot.html"><a href="dot.html#lambda"><i class="fa fa-check"></i><b>18.3</b> Lambda函数</a></li>
<li class="chapter" data-level="18.4" data-path="dot.html"><a href="dot.html#section-149"><i class="fa fa-check"></i><b>18.4</b> 正则表达式</a></li>
<li class="chapter" data-level="18.5" data-path="dot.html"><a href="dot.html#unary-funciton-"><i class="fa fa-check"></i><b>18.5</b> Unary funciton (只带一个参数的函数)</a></li>
<li class="chapter" data-level="18.6" data-path="dot.html"><a href="dot.html#more-placeholder"><i class="fa fa-check"></i><b>18.6</b> more placeholder</a></li>
<li class="chapter" data-level="18.7" data-path="dot.html"><a href="dot.html#mutatemap"><i class="fa fa-check"></i><b>18.7</b> 当mutate遇到map</a></li>
<li class="chapter" data-level="18.8" data-path="dot.html"><a href="dot.html#dot-dot-dot"><i class="fa fa-check"></i><b>18.8</b> Dot dot dot</a></li>
<li class="chapter" data-level="18.9" data-path="dot.html"><a href="dot.html#dont-confuse"><i class="fa fa-check"></i><b>18.9</b> Don’t confuse</a></li>
<li class="chapter" data-level="18.10" data-path="dot.html"><a href="dot.html#section-150"><i class="fa fa-check"></i><b>18.10</b> 小结</a></li>
<li class="chapter" data-level="18.11" data-path="dot.html"><a href="dot.html#section-151"><i class="fa fa-check"></i><b>18.11</b> 回答问题</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="rvest.html"><a href="rvest.html"><i class="fa fa-check"></i><b>19</b> 网络爬虫</a><ul>
<li class="chapter" data-level="19.1" data-path="rvest.html"><a href="rvest.html#section-152"><i class="fa fa-check"></i><b>19.1</b> 链家网</a></li>
<li class="chapter" data-level="19.2" data-path="rvest.html"><a href="rvest.html#section-153"><i class="fa fa-check"></i><b>19.2</b> 猪肉价格</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="tidygraph.html"><a href="tidygraph.html"><i class="fa fa-check"></i><b>20</b> 社会网络分析</a><ul>
<li class="chapter" data-level="20.1" data-path="tidygraph.html"><a href="tidygraph.html#section-154"><i class="fa fa-check"></i><b>20.1</b> 图论基本知识</a></li>
<li class="chapter" data-level="20.2" data-path="tidygraph.html"><a href="tidygraph.html#section-155"><i class="fa fa-check"></i><b>20.2</b> 网络分析</a><ul>
<li class="chapter" data-level="20.2.1" data-path="tidygraph.html"><a href="tidygraph.html#tidygraph-a-tidy-api-for-graph-manipulation"><i class="fa fa-check"></i><b>20.2.1</b> tidygraph: A tidy API for graph manipulation</a></li>
<li class="chapter" data-level="20.2.2" data-path="tidygraph.html"><a href="tidygraph.html#tidy-network-anaylsis"><i class="fa fa-check"></i><b>20.2.2</b> Tidy Network Anaylsis</a></li>
<li class="chapter" data-level="20.2.3" data-path="tidygraph.html"><a href="tidygraph.html#create-network-objects"><i class="fa fa-check"></i><b>20.2.3</b> Create network objects</a></li>
<li class="chapter" data-level="20.2.4" data-path="tidygraph.html"><a href="tidygraph.html#use-tbl_graph"><i class="fa fa-check"></i><b>20.2.4</b> Use <code>tbl_graph</code></a></li>
<li class="chapter" data-level="20.2.5" data-path="tidygraph.html"><a href="tidygraph.html#use-as_tbl_graph"><i class="fa fa-check"></i><b>20.2.5</b> Use <code>as_tbl_graph</code></a></li>
<li class="chapter" data-level="20.2.6" data-path="tidygraph.html"><a href="tidygraph.html#print-out-a-network-object"><i class="fa fa-check"></i><b>20.2.6</b> Print out a network object</a></li>
<li class="chapter" data-level="20.2.7" data-path="tidygraph.html"><a href="tidygraph.html#extract-the-current-active-data"><i class="fa fa-check"></i><b>20.2.7</b> extract the current active data</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="tidygraph.html"><a href="tidygraph.html#network-graph-manipulation"><i class="fa fa-check"></i><b>20.3</b> Network graph manipulation</a><ul>
<li class="chapter" data-level="20.3.1" data-path="tidygraph.html"><a href="tidygraph.html#car-groups-info-number-of-cylinders"><i class="fa fa-check"></i><b>20.3.1</b> Car groups info (Number of cylinders)</a></li>
<li class="chapter" data-level="20.3.2" data-path="tidygraph.html"><a href="tidygraph.html#modify-the-nodes-data"><i class="fa fa-check"></i><b>20.3.2</b> Modify the nodes data:</a></li>
<li class="chapter" data-level="20.3.3" data-path="tidygraph.html"><a href="tidygraph.html#modify-the-edge-data."><i class="fa fa-check"></i><b>20.3.3</b> Modify the edge data.</a></li>
<li class="chapter" data-level="20.3.4" data-path="tidygraph.html"><a href="tidygraph.html#display-the-final-modified-graphs-object"><i class="fa fa-check"></i><b>20.3.4</b> Display the final modified graphs object:</a></li>
<li class="chapter" data-level="20.3.5" data-path="tidygraph.html"><a href="tidygraph.html#visualize-the-correlation-network"><i class="fa fa-check"></i><b>20.3.5</b> Visualize the correlation network</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="tidygraph.html"><a href="tidygraph.html#network-analysis"><i class="fa fa-check"></i><b>20.4</b> Network analysis</a><ul>
<li class="chapter" data-level="20.4.1" data-path="tidygraph.html"><a href="tidygraph.html#centrality"><i class="fa fa-check"></i><b>20.4.1</b> Centrality</a></li>
<li class="chapter" data-level="20.4.2" data-path="tidygraph.html"><a href="tidygraph.html#clustering"><i class="fa fa-check"></i><b>20.4.2</b> Clustering</a></li>
<li class="chapter" data-level="20.4.3" data-path="tidygraph.html"><a href="tidygraph.html#more-algorithms"><i class="fa fa-check"></i><b>20.4.3</b> More Algorithms</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="tidygraph.html"><a href="tidygraph.html#section-156"><i class="fa fa-check"></i><b>20.5</b> 小结</a></li>
<li class="chapter" data-level="20.6" data-path="tidygraph.html"><a href="tidygraph.html#network-visualization"><i class="fa fa-check"></i><b>20.6</b> Network Visualization</a><ul>
<li class="chapter" data-level="20.6.1" data-path="tidygraph.html"><a href="tidygraph.html#ggraph-a-grammar-of-graphics-for-relational-data"><i class="fa fa-check"></i><b>20.6.1</b> ggraph: A grammar of graphics for relational data</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="tidygraph.html"><a href="tidygraph.html#section-157"><i class="fa fa-check"></i><b>20.7</b> 扩展阅读</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="tidytext.html"><a href="tidytext.html"><i class="fa fa-check"></i><b>21</b> 文本挖掘</a></li>
<li class="chapter" data-level="22" data-path="tidyeval.html"><a href="tidyeval.html"><i class="fa fa-check"></i><b>22</b> 非标准性评估</a></li>
<li class="appendix"><span><b>附录</b></span></li>
<li class="chapter" data-level="A" data-path="exams.html"><a href="exams.html"><i class="fa fa-check"></i><b>A</b> 期末考试</a><ul>
<li class="chapter" data-level="A.1" data-path="exams.html"><a href="exams.html#section-158"><i class="fa fa-check"></i><b>A.1</b> 方式</a></li>
<li class="chapter" data-level="A.2" data-path="exams.html"><a href="exams.html#section-159"><i class="fa fa-check"></i><b>A.2</b> 要求</a></li>
<li class="chapter" data-level="A.3" data-path="exams.html"><a href="exams.html#section-160"><i class="fa fa-check"></i><b>A.3</b> 数据集</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">本书由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">数据科学中的 R 语言</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sampling" class="section level1">
<h1><span class="header-section-number">第 13 章</span> 模拟与抽样</h1>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb598-1" title="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<p>本章目的是在tidyverse的架构下，介绍一些模拟和抽样的知识。先回顾下Hadley Wickham提出的数据科学tidy原则，tidy思想体现在:</p>
<ul>
<li>任何数据都可以规整为数据框</li>
<li>数据框的一列代表一个<strong>变量</strong>，数据框的一行代表一次<strong>观察</strong></li>
<li>函数处理数据时，数据框进、数据框出</li>
</ul>
<div id="section-115" class="section level2">
<h2><span class="header-section-number">13.1</span> 模拟</h2>
<div id="section-116" class="section level3">
<h3><span class="header-section-number">13.1.1</span> 生成随机数</h3>
<p>比如生成5个高斯分布的随机数，高斯分布就是正态分布，R语言里我们用<code>rnorm()</code>函数产生正态分布的随机数</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb599-1" title="1"><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">5</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] -0.2194 -0.4139  1.0770  1.7390  0.3412</code></pre>
<p>事实上，R内置了很多随机数产生的函数</p>
<table>
<thead>
<tr class="header">
<th>Distrution</th>
<th align="center">Notation</th>
<th align="center">R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Uniform</td>
<td align="center"><span class="math inline">\(\text{U}(a, b)\)</span></td>
<td align="center"><code>runif</code></td>
</tr>
<tr class="even">
<td>Normal</td>
<td align="center"><span class="math inline">\(\text{N}(\mu, \sigma)\)</span></td>
<td align="center"><code>rnorm</code></td>
</tr>
<tr class="odd">
<td>Binormal</td>
<td align="center"><span class="math inline">\(\text{Bin}(n, p)\)</span></td>
<td align="center"><code>rbinorm</code></td>
</tr>
<tr class="even">
<td>Piosson</td>
<td align="center"><span class="math inline">\(\text{pois}(\lambda)\)</span></td>
<td align="center"><code>rpois</code></td>
</tr>
<tr class="odd">
<td>Beta</td>
<td align="center"><span class="math inline">\(\text{Beta}(\alpha, \beta)\)</span></td>
<td align="center"><code>rbeta</code></td>
</tr>
</tbody>
</table>
<p>如果大家查看帮助文档<code>?runif</code>，会发现每种<strong>分布</strong>都有对应的四个函数</p>
<ul>
<li><code>d</code>:density</li>
<li><code>p</code>:cumulative probability</li>
<li><code>q</code>:quantile</li>
<li><code>r</code>:random</li>
</ul>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb601-1" title="1"><span class="kw">dnorm</span>(<span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dt">length.out =</span> <span class="dv">10</span>), <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>##  [1] 0.3970 0.3948 0.3919 0.3882 0.3838 0.3788 0.3730
##  [8] 0.3666 0.3596 0.3521</code></pre>
<p>在tidyverse的框架下，我们喜欢在数据框(data.frame)下运用这些函数，因为这样我们可以方便使用ggplot2来可视化，</p>
<ul>
<li>例子1，我们生成100个正态分布的点，然后看看其分布</li>
</ul>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb603-1" title="1"><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb603-2" title="2">  <span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb603-3" title="3">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb603-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb603-5" title="5"><span class="st">  </span><span class="kw">geom_density</span>()</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-521-1.png" width="576" /></p>
<p>我们将模拟的正态分布和理论上正态分布画在一起</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb604-1" title="1"><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb604-2" title="2">  <span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb604-3" title="3">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb604-4" title="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb604-5" title="5"><span class="st">  </span><span class="kw">geom_density</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb604-6" title="6"><span class="st">  </span><span class="kw">stat_function</span>(</a>
<a class="sourceLine" id="cb604-7" title="7">    <span class="dt">fun =</span> dnorm,</a>
<a class="sourceLine" id="cb604-8" title="8">    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb604-9" title="9">    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span></a>
<a class="sourceLine" id="cb604-10" title="10">  )</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-522-1.png" width="576" />
如果我们模拟点再增加点，会越来越逼近理论上的分布。</p>
<ul>
<li>例子2，在数据框(data.frame)下，建立模拟<span class="math inline">\(x\)</span>和<span class="math inline">\(y\)</span>的线性关系</li>
</ul>
<p><span class="math display">\[ y_i  = 4 + 3.2\, x_i\]</span>
现实中，观察值往往会带入误差，假定误差服从正态分布，那么<span class="math inline">\(x\)</span>和<span class="math inline">\(y\)</span>的线性关系重新表述为
<span class="math display">\[ y_i  = \beta_0 + \beta_1\, x_i + \epsilon_i, \quad \epsilon \in \text{Normal}(\mu =0, \sigma =1) \]</span></p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb605-1" title="1">beta_<span class="dv">0</span>  &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb605-2" title="2">beta_<span class="dv">1</span>  &lt;-<span class="st"> </span><span class="fl">3.2</span></a>
<a class="sourceLine" id="cb605-3" title="3">epsilon &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">1000</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb605-4" title="4"></a>
<a class="sourceLine" id="cb605-5" title="5">sim_normal &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb605-6" title="6"> <span class="co"># x_vals = runif(1000, 0, 10)</span></a>
<a class="sourceLine" id="cb605-7" title="7">  </a>
<a class="sourceLine" id="cb605-8" title="8">  <span class="dt">x_vals =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">5</span>, <span class="dt">length.out =</span> <span class="dv">1000</span>),</a>
<a class="sourceLine" id="cb605-9" title="9">  <span class="dt">y_vals =</span> beta_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>beta_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>x_vals <span class="op">+</span><span class="st"> </span>epsilon,</a>
<a class="sourceLine" id="cb605-10" title="10">)</a>
<a class="sourceLine" id="cb605-11" title="11"></a>
<a class="sourceLine" id="cb605-12" title="12">sim_normal <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["x_vals"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["y_vals"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.000000","2":"2.364"},{"1":"0.005005","2":"2.355"},{"1":"0.010010","2":"4.496"},{"1":"0.015015","2":"4.257"},{"1":"0.020020","2":"2.761"},{"1":"0.025025","2":"6.237"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb606-1" title="1">sim_normal <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb606-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x_vals, <span class="dt">y =</span> y_vals)) <span class="op">+</span></a>
<a class="sourceLine" id="cb606-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>()</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-524-1.png" width="576" /></p>
<p>有时候为了方便，可以写简练点</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb607-1" title="1"><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb607-2" title="2">  <span class="dt">a =</span> <span class="kw">runif</span>(<span class="dv">1000</span>, <span class="dv">0</span>, <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb607-3" title="3">  <span class="dt">b =</span> <span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>, <span class="dt">mean =</span> <span class="fl">3.2</span> <span class="op">*</span><span class="st"> </span>a, <span class="dt">sd =</span> <span class="dv">1</span>) </a>
<a class="sourceLine" id="cb607-4" title="4">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb607-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> a, <span class="dt">y =</span> b)) <span class="op">+</span></a>
<a class="sourceLine" id="cb607-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>() </a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-525-1.png" width="576" /></p>
</div>
</div>
<div id="massmvrnorm" class="section level2">
<h2><span class="header-section-number">13.2</span> MASS::mvrnorm</h2>
<p><code>MASS::mvrnorm(n = 1, mu,  Sigma)</code>产生多元高斯分布的随机数，每组随机变量高度相关。
比如人的身高服从正态分布，人的体重也服从正态分布，同时身高和体重又存在强烈的关联。</p>
<ul>
<li><code>n</code>: 随机样本的大小</li>
<li><code>mu</code>: 多元高斯分布的均值向量</li>
<li><code>Sigma</code>: 协方差矩阵，主要这里是大写的S (Sigma)，提醒我们它是一个矩阵，不是一个数值</li>
</ul>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb608-1" title="1">a &lt;-<span class="st"> </span><span class="fl">3.5</span> </a>
<a class="sourceLine" id="cb608-2" title="2">b &lt;-<span class="st"> </span><span class="dv">-1</span> </a>
<a class="sourceLine" id="cb608-3" title="3">sigma_a &lt;-<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb608-4" title="4">sigma_b &lt;-<span class="st"> </span><span class="fl">0.5</span> </a>
<a class="sourceLine" id="cb608-5" title="5">rho &lt;-<span class="st"> </span><span class="fl">-0.7</span> </a>
<a class="sourceLine" id="cb608-6" title="6"></a>
<a class="sourceLine" id="cb608-7" title="7">mu &lt;-<span class="st"> </span><span class="kw">c</span>(a, b)</a>
<a class="sourceLine" id="cb608-8" title="8">cov_ab &lt;-<span class="st"> </span>sigma_a <span class="op">*</span><span class="st"> </span>sigma_b <span class="op">*</span><span class="st"> </span>rho <span class="co"># 协方差</span></a></code></pre></div>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb609-1" title="1"><span class="co"># 构建协方差矩阵</span></a>
<a class="sourceLine" id="cb609-2" title="2">sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(sigma_a<span class="op">^</span><span class="dv">2</span>, cov_ab,</a>
<a class="sourceLine" id="cb609-3" title="3">                  cov_ab, sigma_b<span class="op">^</span><span class="dv">2</span>), <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb610-1" title="1">d &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dv">1000</span>, <span class="dt">mu =</span> mu, <span class="dt">Sigma =</span> sigma) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb610-2" title="2"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb610-3" title="3"><span class="st">  </span><span class="kw">set_names</span>(<span class="st">&quot;group_a&quot;</span>, <span class="st">&quot;group_b&quot;</span>)</a>
<a class="sourceLine" id="cb610-4" title="4"></a>
<a class="sourceLine" id="cb610-5" title="5">d</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["group_a"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["group_b"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2.91208","2":"-0.852536"},{"1":"2.48486","2":"-0.785994"},{"1":"4.39043","2":"-1.340592"},{"1":"3.95882","2":"-0.752155"},{"1":"4.15416","2":"-0.889735"},{"1":"4.41913","2":"-1.476169"},{"1":"2.26190","2":"-0.409078"},{"1":"3.51458","2":"-0.404086"},{"1":"3.34210","2":"-1.307472"},{"1":"4.48334","2":"-1.351208"},{"1":"3.94139","2":"-1.332237"},{"1":"4.16488","2":"-1.939324"},{"1":"4.07836","2":"-1.571279"},{"1":"2.87134","2":"-0.605675"},{"1":"3.64538","2":"-1.034850"},{"1":"3.40214","2":"-0.848147"},{"1":"3.96971","2":"-0.768507"},{"1":"4.70224","2":"-1.585133"},{"1":"2.15958","2":"-0.536313"},{"1":"4.03919","2":"-1.616704"},{"1":"4.12106","2":"-1.071193"},{"1":"3.23856","2":"-0.742865"},{"1":"3.25414","2":"-1.253042"},{"1":"4.28608","2":"-1.207181"},{"1":"6.40537","2":"-2.053071"},{"1":"3.51978","2":"-1.444384"},{"1":"4.66394","2":"-1.740783"},{"1":"2.94174","2":"-0.918020"},{"1":"4.27835","2":"-1.170141"},{"1":"4.76697","2":"-1.434991"},{"1":"2.08724","2":"-0.402281"},{"1":"3.90801","2":"-1.620539"},{"1":"4.73994","2":"-1.326183"},{"1":"3.49097","2":"-0.896237"},{"1":"4.22988","2":"-1.114594"},{"1":"2.92138","2":"-0.557588"},{"1":"5.29381","2":"-1.411580"},{"1":"3.45881","2":"-0.639481"},{"1":"5.74659","2":"-1.145263"},{"1":"2.80659","2":"-0.615259"},{"1":"3.73738","2":"-0.794091"},{"1":"3.29980","2":"-0.379374"},{"1":"2.59768","2":"-0.401571"},{"1":"1.81495","2":"0.116235"},{"1":"3.33642","2":"-1.103904"},{"1":"5.26205","2":"-1.723384"},{"1":"3.90330","2":"-1.134573"},{"1":"3.46299","2":"-0.665627"},{"1":"3.03090","2":"-0.820432"},{"1":"2.29321","2":"-0.812297"},{"1":"3.50312","2":"-1.019988"},{"1":"4.33943","2":"-1.537769"},{"1":"4.10635","2":"-1.533613"},{"1":"3.21517","2":"-1.516147"},{"1":"3.41189","2":"-1.118861"},{"1":"2.26371","2":"-0.367935"},{"1":"3.39934","2":"-0.464781"},{"1":"4.86805","2":"-1.909994"},{"1":"3.25296","2":"-1.147910"},{"1":"4.14794","2":"-1.600016"},{"1":"5.71849","2":"-2.263283"},{"1":"3.47278","2":"-1.144164"},{"1":"3.35869","2":"-0.429928"},{"1":"2.51575","2":"-1.244955"},{"1":"5.04338","2":"-1.522301"},{"1":"4.58840","2":"-1.062584"},{"1":"4.46880","2":"-1.561956"},{"1":"3.22849","2":"-1.092053"},{"1":"2.46035","2":"-0.985602"},{"1":"6.35704","2":"-2.194259"},{"1":"3.35339","2":"-0.676650"},{"1":"1.58426","2":"-1.092575"},{"1":"3.59367","2":"-1.023685"},{"1":"3.53099","2":"-0.779147"},{"1":"4.63261","2":"-2.220149"},{"1":"2.03272","2":"-0.630351"},{"1":"4.75499","2":"-1.564510"},{"1":"4.49564","2":"-1.696892"},{"1":"3.79762","2":"-2.070369"},{"1":"2.87033","2":"-0.464621"},{"1":"3.80411","2":"-0.832954"},{"1":"4.07393","2":"-0.466747"},{"1":"3.39383","2":"-0.981085"},{"1":"4.74582","2":"-1.299451"},{"1":"4.50935","2":"-1.965724"},{"1":"2.74216","2":"-0.818928"},{"1":"3.40448","2":"-1.183686"},{"1":"3.35990","2":"-0.740644"},{"1":"3.02709","2":"-0.762039"},{"1":"3.84380","2":"-1.378994"},{"1":"4.53153","2":"-1.103047"},{"1":"3.31495","2":"-0.969892"},{"1":"4.11315","2":"-1.558276"},{"1":"2.80377","2":"-1.209234"},{"1":"4.72619","2":"-1.687995"},{"1":"3.93207","2":"-1.353181"},{"1":"2.65105","2":"-0.390920"},{"1":"4.66547","2":"-1.142964"},{"1":"4.55999","2":"-1.153443"},{"1":"2.76570","2":"-0.165552"},{"1":"2.17739","2":"-0.108178"},{"1":"2.69102","2":"-0.811253"},{"1":"3.94531","2":"-1.218960"},{"1":"3.71590","2":"-0.803256"},{"1":"3.12529","2":"-0.922025"},{"1":"4.15133","2":"-1.718509"},{"1":"3.12467","2":"-1.253809"},{"1":"1.58101","2":"-0.514777"},{"1":"2.36753","2":"-0.554709"},{"1":"3.30112","2":"-1.418447"},{"1":"1.56239","2":"-0.568666"},{"1":"2.18038","2":"-0.976277"},{"1":"4.35105","2":"-1.312705"},{"1":"3.83207","2":"-1.115989"},{"1":"3.72390","2":"-0.937454"},{"1":"4.67527","2":"-1.445070"},{"1":"3.13823","2":"-1.081738"},{"1":"3.27346","2":"-1.066098"},{"1":"4.22795","2":"-1.065746"},{"1":"3.71717","2":"-1.176712"},{"1":"5.66540","2":"-1.422990"},{"1":"3.27968","2":"-0.862320"},{"1":"2.50901","2":"-0.694830"},{"1":"1.86067","2":"-0.252617"},{"1":"2.38261","2":"-0.561621"},{"1":"2.67116","2":"-0.427410"},{"1":"3.68723","2":"-0.472755"},{"1":"4.39296","2":"-1.264650"},{"1":"4.13987","2":"-0.903871"},{"1":"4.52340","2":"-1.733668"},{"1":"3.09711","2":"-0.537025"},{"1":"2.99997","2":"-0.709951"},{"1":"3.86273","2":"-1.226629"},{"1":"3.94358","2":"-1.254974"},{"1":"4.64233","2":"-2.380925"},{"1":"4.14301","2":"-1.671924"},{"1":"3.15707","2":"-1.690214"},{"1":"3.44920","2":"-0.897041"},{"1":"3.21792","2":"-0.537894"},{"1":"3.63164","2":"-1.117720"},{"1":"4.15206","2":"-1.050491"},{"1":"3.46528","2":"-0.994938"},{"1":"4.53186","2":"-1.752312"},{"1":"2.68829","2":"-0.185039"},{"1":"2.39937","2":"-0.711300"},{"1":"3.37942","2":"-1.817590"},{"1":"3.64374","2":"-0.577374"},{"1":"3.08885","2":"-1.077502"},{"1":"2.61723","2":"-1.430403"},{"1":"2.69748","2":"-0.013590"},{"1":"4.66982","2":"-1.599031"},{"1":"4.65318","2":"-1.305527"},{"1":"4.35768","2":"-1.226799"},{"1":"1.77054","2":"-0.734049"},{"1":"2.81419","2":"-0.671228"},{"1":"2.72429","2":"-0.513372"},{"1":"3.96325","2":"-1.391725"},{"1":"3.86157","2":"-1.013008"},{"1":"0.09075","2":"0.271430"},{"1":"4.07016","2":"-1.233430"},{"1":"2.70299","2":"-0.936132"},{"1":"3.15538","2":"-0.604769"},{"1":"3.92729","2":"-1.429387"},{"1":"4.02333","2":"-1.034709"},{"1":"2.15085","2":"-0.955308"},{"1":"3.90533","2":"-0.744836"},{"1":"2.23906","2":"-1.057674"},{"1":"3.71131","2":"-0.932544"},{"1":"3.42957","2":"-0.512942"},{"1":"3.07333","2":"-1.105836"},{"1":"1.15235","2":"0.116716"},{"1":"4.54153","2":"-1.943751"},{"1":"4.81346","2":"-1.078581"},{"1":"4.81513","2":"-1.052239"},{"1":"3.96141","2":"-1.143568"},{"1":"2.90931","2":"-1.228456"},{"1":"3.71254","2":"-0.655533"},{"1":"3.69776","2":"-0.962403"},{"1":"2.26748","2":"0.377606"},{"1":"3.52777","2":"-1.373319"},{"1":"4.30005","2":"-0.737741"},{"1":"3.63036","2":"-0.991442"},{"1":"4.18756","2":"-0.410384"},{"1":"5.46463","2":"-1.424123"},{"1":"3.65298","2":"-0.757346"},{"1":"4.78483","2":"-1.546528"},{"1":"3.03317","2":"-1.390764"},{"1":"4.37536","2":"-1.105504"},{"1":"1.42277","2":"-0.548493"},{"1":"2.68785","2":"-0.534288"},{"1":"2.41959","2":"-0.784031"},{"1":"3.62360","2":"-1.571267"},{"1":"3.36221","2":"-0.864507"},{"1":"2.88873","2":"-0.759866"},{"1":"3.84715","2":"-1.017015"},{"1":"3.67085","2":"-1.529173"},{"1":"2.29753","2":"-0.816782"},{"1":"3.94594","2":"-1.117200"},{"1":"2.98944","2":"-0.781647"},{"1":"3.24622","2":"-1.078432"},{"1":"3.86453","2":"-0.716498"},{"1":"4.45471","2":"-1.145312"},{"1":"1.53475","2":"-0.795313"},{"1":"5.05470","2":"-0.619901"},{"1":"3.61922","2":"-0.543432"},{"1":"3.82823","2":"-0.982153"},{"1":"3.48590","2":"-0.465843"},{"1":"2.50961","2":"-0.998065"},{"1":"2.15199","2":"-0.968206"},{"1":"4.01130","2":"-0.885867"},{"1":"4.45658","2":"-1.633254"},{"1":"2.88514","2":"-0.866956"},{"1":"4.55962","2":"-1.682455"},{"1":"3.02750","2":"-0.689654"},{"1":"3.69731","2":"-1.489825"},{"1":"3.82086","2":"-0.962581"},{"1":"4.07386","2":"-1.543627"},{"1":"2.85618","2":"-0.597091"},{"1":"3.21908","2":"-0.550673"},{"1":"2.06091","2":"-0.270120"},{"1":"5.27611","2":"-1.344496"},{"1":"2.97093","2":"-1.153059"},{"1":"4.20874","2":"-1.003859"},{"1":"3.90927","2":"-1.481032"},{"1":"1.55444","2":"-0.257162"},{"1":"2.96784","2":"-0.300171"},{"1":"4.15201","2":"-2.032955"},{"1":"4.25685","2":"-0.781142"},{"1":"4.73348","2":"-1.460689"},{"1":"3.51855","2":"-0.817438"},{"1":"4.40828","2":"-2.064977"},{"1":"3.38360","2":"-1.625064"},{"1":"2.60363","2":"-0.369077"},{"1":"3.90539","2":"-1.160711"},{"1":"3.11975","2":"-0.020216"},{"1":"3.13368","2":"-0.933634"},{"1":"3.05416","2":"-1.469066"},{"1":"4.42654","2":"-1.535166"},{"1":"3.55015","2":"-1.892007"},{"1":"4.49817","2":"-0.951601"},{"1":"3.96269","2":"-1.209426"},{"1":"3.05672","2":"-1.653156"},{"1":"3.19129","2":"-1.287466"},{"1":"2.39266","2":"-0.737910"},{"1":"2.18808","2":"-0.764647"},{"1":"2.15441","2":"-1.008993"},{"1":"3.23038","2":"-1.029814"},{"1":"3.77171","2":"-1.614632"},{"1":"4.39637","2":"-1.734406"},{"1":"3.45413","2":"-0.621618"},{"1":"3.82863","2":"-1.130138"},{"1":"3.03672","2":"-0.211752"},{"1":"3.08228","2":"-0.906241"},{"1":"1.96899","2":"-0.864622"},{"1":"5.52985","2":"-1.780143"},{"1":"5.75554","2":"-1.521746"},{"1":"4.08036","2":"-1.332594"},{"1":"2.28915","2":"-0.198479"},{"1":"2.46533","2":"-0.439078"},{"1":"5.52843","2":"-1.605324"},{"1":"1.53411","2":"0.165200"},{"1":"3.88539","2":"-0.989924"},{"1":"4.87194","2":"-1.669940"},{"1":"2.10541","2":"-0.439967"},{"1":"3.60757","2":"-1.347274"},{"1":"1.22798","2":"-0.401907"},{"1":"2.97426","2":"-1.355241"},{"1":"3.95170","2":"-1.057365"},{"1":"3.69120","2":"-1.217703"},{"1":"3.25624","2":"-0.669416"},{"1":"2.84450","2":"-0.637947"},{"1":"6.44109","2":"-1.680232"},{"1":"3.80404","2":"-1.144689"},{"1":"6.20290","2":"-2.326561"},{"1":"4.87804","2":"-0.618309"},{"1":"3.01213","2":"-0.828271"},{"1":"2.57522","2":"-0.239460"},{"1":"3.39460","2":"-0.979437"},{"1":"2.67259","2":"-0.973133"},{"1":"3.06210","2":"-1.551611"},{"1":"2.80756","2":"-0.272717"},{"1":"3.10041","2":"-0.667645"},{"1":"2.63041","2":"-0.129673"},{"1":"2.94110","2":"-0.569343"},{"1":"2.91857","2":"-0.661011"},{"1":"4.62565","2":"-1.914266"},{"1":"4.08261","2":"-1.216508"},{"1":"4.77285","2":"-1.698418"},{"1":"4.30129","2":"-1.623885"},{"1":"2.30842","2":"-1.186737"},{"1":"2.60146","2":"-0.381074"},{"1":"2.34979","2":"-1.027844"},{"1":"3.32495","2":"-0.567284"},{"1":"4.94220","2":"-1.563452"},{"1":"4.33150","2":"-1.172363"},{"1":"5.64828","2":"-1.743903"},{"1":"1.53051","2":"-0.562033"},{"1":"3.15934","2":"-0.537411"},{"1":"2.46775","2":"-0.763062"},{"1":"4.71370","2":"-1.351729"},{"1":"1.60979","2":"-0.699570"},{"1":"2.75978","2":"-0.147300"},{"1":"1.79305","2":"-0.240616"},{"1":"4.95418","2":"-1.989269"},{"1":"3.33314","2":"-0.428058"},{"1":"3.86944","2":"-1.621577"},{"1":"3.80046","2":"-1.197903"},{"1":"3.95768","2":"-1.318923"},{"1":"3.02536","2":"-0.992832"},{"1":"2.57732","2":"-1.241743"},{"1":"3.26866","2":"-1.147010"},{"1":"2.20270","2":"-0.471365"},{"1":"3.30883","2":"-0.871306"},{"1":"2.31450","2":"-0.768357"},{"1":"3.56430","2":"-0.379110"},{"1":"3.22082","2":"-0.769907"},{"1":"1.25665","2":"-0.061204"},{"1":"1.96550","2":"-0.810752"},{"1":"3.69467","2":"-1.231701"},{"1":"2.80100","2":"-0.599496"},{"1":"3.89979","2":"-1.067128"},{"1":"2.37075","2":"-0.736025"},{"1":"4.72264","2":"-1.587744"},{"1":"3.04183","2":"0.012608"},{"1":"1.54030","2":"0.069259"},{"1":"3.33576","2":"-0.736699"},{"1":"3.68942","2":"-0.656235"},{"1":"3.31061","2":"-0.743187"},{"1":"3.33106","2":"-0.288337"},{"1":"4.18799","2":"-1.900289"},{"1":"3.73871","2":"-1.160571"},{"1":"4.00408","2":"-1.191183"},{"1":"4.18465","2":"-1.256579"},{"1":"4.01279","2":"-1.128219"},{"1":"4.88118","2":"-1.893316"},{"1":"3.58601","2":"-0.478016"},{"1":"1.75165","2":"-0.472587"},{"1":"2.65094","2":"-0.632860"},{"1":"3.22913","2":"-0.748160"},{"1":"2.86048","2":"-0.975911"},{"1":"3.89877","2":"-1.050255"},{"1":"2.80335","2":"-1.550989"},{"1":"2.61479","2":"-0.612821"},{"1":"2.90705","2":"-0.659837"},{"1":"4.44458","2":"-1.847648"},{"1":"3.16491","2":"-0.668449"},{"1":"4.49709","2":"-1.724291"},{"1":"3.21771","2":"-0.625334"},{"1":"2.91931","2":"-0.729941"},{"1":"2.60827","2":"-0.457567"},{"1":"3.47132","2":"-0.898644"},{"1":"3.37266","2":"-0.661765"},{"1":"3.04201","2":"-1.232085"},{"1":"4.23804","2":"-1.197927"},{"1":"4.40524","2":"-1.278630"},{"1":"4.70989","2":"-1.721087"},{"1":"1.91270","2":"-0.847125"},{"1":"4.23045","2":"-1.286551"},{"1":"2.40187","2":"-0.744742"},{"1":"3.40519","2":"-0.841724"},{"1":"2.07703","2":"-0.039518"},{"1":"3.64258","2":"-0.323482"},{"1":"4.59021","2":"-1.308162"},{"1":"4.91973","2":"-1.063217"},{"1":"5.57853","2":"-2.298869"},{"1":"3.02676","2":"-1.056744"},{"1":"2.49825","2":"-0.425892"},{"1":"2.73622","2":"-0.628064"},{"1":"1.58025","2":"-0.375129"},{"1":"3.73436","2":"-1.347990"},{"1":"3.97397","2":"-0.912531"},{"1":"5.07300","2":"-1.488244"},{"1":"2.72858","2":"-0.533708"},{"1":"5.20619","2":"-1.106540"},{"1":"5.50951","2":"-1.812008"},{"1":"3.92630","2":"-1.504095"},{"1":"4.15483","2":"-0.569816"},{"1":"1.84692","2":"0.220171"},{"1":"4.24542","2":"-1.828923"},{"1":"4.10117","2":"-1.240117"},{"1":"4.23252","2":"-1.134037"},{"1":"3.07570","2":"-0.295440"},{"1":"2.48314","2":"-0.688890"},{"1":"3.86040","2":"-0.788460"},{"1":"3.33009","2":"-0.923630"},{"1":"2.72331","2":"-1.405276"},{"1":"3.12075","2":"-1.077218"},{"1":"2.67102","2":"-0.111024"},{"1":"3.27495","2":"-1.283319"},{"1":"4.33374","2":"-1.765304"},{"1":"3.55766","2":"-0.795553"},{"1":"3.10600","2":"-0.475359"},{"1":"4.32610","2":"-1.500113"},{"1":"4.60224","2":"-2.143074"},{"1":"1.03705","2":"0.069617"},{"1":"3.39600","2":"-1.376999"},{"1":"3.44579","2":"-1.192388"},{"1":"3.36622","2":"-0.358474"},{"1":"2.43645","2":"-0.799811"},{"1":"4.06071","2":"-1.332974"},{"1":"3.22323","2":"-0.688827"},{"1":"5.15975","2":"-1.420977"},{"1":"2.87783","2":"-0.815473"},{"1":"4.88747","2":"-1.784723"},{"1":"2.65302","2":"-0.600622"},{"1":"3.75583","2":"-1.007982"},{"1":"3.91474","2":"-1.010852"},{"1":"2.87357","2":"-0.549515"},{"1":"4.34832","2":"-0.767202"},{"1":"4.21137","2":"-1.136706"},{"1":"5.44178","2":"-1.521078"},{"1":"3.17420","2":"-0.543635"},{"1":"3.50558","2":"-1.351147"},{"1":"3.17568","2":"-0.940917"},{"1":"3.81800","2":"-0.927437"},{"1":"4.10404","2":"-0.856308"},{"1":"3.80767","2":"-1.481372"},{"1":"3.00304","2":"-1.116795"},{"1":"2.82702","2":"-0.475120"},{"1":"5.15341","2":"-0.973644"},{"1":"3.74179","2":"-0.987865"},{"1":"1.94667","2":"-0.554707"},{"1":"3.94844","2":"-1.515175"},{"1":"4.29897","2":"-1.750103"},{"1":"1.84068","2":"0.111426"},{"1":"2.13980","2":"-1.343155"},{"1":"3.51484","2":"-1.791748"},{"1":"2.95837","2":"-0.847237"},{"1":"3.41398","2":"-1.198353"},{"1":"4.53065","2":"-2.024523"},{"1":"3.33788","2":"-0.862920"},{"1":"2.92129","2":"-0.951015"},{"1":"4.43415","2":"-0.687139"},{"1":"4.41223","2":"-1.445725"},{"1":"4.33503","2":"-1.744206"},{"1":"2.88569","2":"-0.397007"},{"1":"2.86956","2":"-0.845882"},{"1":"1.76976","2":"0.258031"},{"1":"3.27455","2":"-0.531568"},{"1":"3.53381","2":"-0.923565"},{"1":"3.42360","2":"-1.145110"},{"1":"4.10518","2":"-0.807761"},{"1":"4.39535","2":"-1.304129"},{"1":"5.83494","2":"-1.695500"},{"1":"3.54504","2":"-1.838447"},{"1":"3.31880","2":"-0.674505"},{"1":"2.57482","2":"-0.381618"},{"1":"3.14569","2":"-1.203217"},{"1":"4.00967","2":"-0.844751"},{"1":"5.56665","2":"-1.733512"},{"1":"2.75109","2":"-1.558819"},{"1":"3.34419","2":"-1.231211"},{"1":"2.67034","2":"-0.859602"},{"1":"4.54885","2":"-1.009982"},{"1":"3.21280","2":"-1.032707"},{"1":"3.07595","2":"-1.607070"},{"1":"3.29529","2":"-0.864346"},{"1":"3.72232","2":"-0.853806"},{"1":"3.55752","2":"-0.938995"},{"1":"2.31929","2":"-0.727829"},{"1":"3.95463","2":"-0.988935"},{"1":"3.44434","2":"-0.462148"},{"1":"2.06852","2":"-0.332932"},{"1":"3.93576","2":"-1.451832"},{"1":"2.50544","2":"-1.286213"},{"1":"4.02985","2":"-1.777845"},{"1":"3.06013","2":"-0.553645"},{"1":"4.49181","2":"-1.615600"},{"1":"2.79681","2":"-1.037960"},{"1":"4.23708","2":"-1.624736"},{"1":"3.09941","2":"-0.840150"},{"1":"4.72294","2":"-1.620881"},{"1":"4.65112","2":"-1.026928"},{"1":"4.19428","2":"-0.734987"},{"1":"5.56287","2":"-1.469418"},{"1":"3.08116","2":"-0.714292"},{"1":"2.79584","2":"-0.478544"},{"1":"5.05275","2":"-1.520203"},{"1":"3.31748","2":"-1.465818"},{"1":"4.10012","2":"-1.222870"},{"1":"2.62961","2":"-0.497630"},{"1":"2.96405","2":"-0.680653"},{"1":"3.40125","2":"-0.866604"},{"1":"3.42489","2":"-0.952503"},{"1":"4.95517","2":"-1.559259"},{"1":"4.42422","2":"-1.232123"},{"1":"2.21944","2":"-0.121943"},{"1":"2.34355","2":"-0.992656"},{"1":"3.62270","2":"-2.062442"},{"1":"2.20435","2":"-0.472426"},{"1":"5.25293","2":"-1.681091"},{"1":"3.72050","2":"-0.954986"},{"1":"4.07192","2":"-1.604234"},{"1":"1.97300","2":"-0.809467"},{"1":"3.59538","2":"-0.931199"},{"1":"3.06168","2":"-0.949294"},{"1":"3.63633","2":"-0.854105"},{"1":"3.64856","2":"-1.025717"},{"1":"3.30554","2":"-0.986629"},{"1":"4.24575","2":"-1.781767"},{"1":"4.38613","2":"-1.247022"},{"1":"5.02057","2":"-1.468555"},{"1":"5.31384","2":"-1.818511"},{"1":"3.19097","2":"-0.771870"},{"1":"2.51609","2":"-0.300148"},{"1":"2.92951","2":"-1.148031"},{"1":"3.26299","2":"-0.296945"},{"1":"4.08294","2":"-1.566388"},{"1":"2.07664","2":"-0.116976"},{"1":"3.07227","2":"-0.824603"},{"1":"3.12610","2":"-0.648130"},{"1":"2.16885","2":"-0.962749"},{"1":"5.11631","2":"-1.482744"},{"1":"2.02933","2":"-0.096771"},{"1":"2.17616","2":"0.017360"},{"1":"3.06377","2":"-0.372144"},{"1":"2.78692","2":"-1.081152"},{"1":"4.41100","2":"-1.195253"},{"1":"4.79370","2":"-1.377773"},{"1":"4.51858","2":"-1.482057"},{"1":"2.00534","2":"-1.103100"},{"1":"2.41004","2":"0.190456"},{"1":"1.96163","2":"-0.611759"},{"1":"3.67911","2":"-0.724020"},{"1":"2.18596","2":"-0.712299"},{"1":"4.51758","2":"-1.427830"},{"1":"3.94061","2":"-0.682025"},{"1":"4.51400","2":"-1.519887"},{"1":"5.59909","2":"-1.090257"},{"1":"4.22792","2":"-1.257278"},{"1":"4.31000","2":"-0.877889"},{"1":"4.75461","2":"-1.247647"},{"1":"5.10510","2":"-1.987339"},{"1":"1.54041","2":"-0.783873"},{"1":"4.36697","2":"-0.902381"},{"1":"5.63811","2":"-2.040844"},{"1":"5.58967","2":"-1.882004"},{"1":"2.49123","2":"-0.613573"},{"1":"4.07001","2":"-1.100602"},{"1":"6.05045","2":"-1.034743"},{"1":"2.12482","2":"-0.415735"},{"1":"4.90416","2":"-1.349285"},{"1":"6.37462","2":"-2.257761"},{"1":"3.77795","2":"-1.065569"},{"1":"3.78134","2":"-1.094445"},{"1":"1.58232","2":"-0.439020"},{"1":"2.71367","2":"-0.777839"},{"1":"4.60809","2":"-1.344276"},{"1":"3.01394","2":"-0.635307"},{"1":"4.04640","2":"-1.846421"},{"1":"3.49056","2":"-1.124167"},{"1":"3.36506","2":"-0.948489"},{"1":"3.41659","2":"-0.325161"},{"1":"2.35677","2":"-0.467194"},{"1":"3.58156","2":"-0.635138"},{"1":"3.76842","2":"-1.369732"},{"1":"3.57641","2":"-1.070961"},{"1":"2.13278","2":"-0.535407"},{"1":"2.98497","2":"-1.121780"},{"1":"4.89585","2":"-1.829607"},{"1":"4.89025","2":"-1.478367"},{"1":"4.76233","2":"-1.563036"},{"1":"2.74274","2":"-0.340486"},{"1":"3.63063","2":"-0.223441"},{"1":"2.27923","2":"-0.674651"},{"1":"3.03159","2":"-1.001290"},{"1":"4.54947","2":"-1.356046"},{"1":"1.44672","2":"-0.609744"},{"1":"3.94752","2":"-1.237270"},{"1":"5.12457","2":"-2.130321"},{"1":"3.59323","2":"-1.819105"},{"1":"2.34604","2":"-0.402884"},{"1":"2.92596","2":"-0.696317"},{"1":"2.43187","2":"-0.488901"},{"1":"3.79534","2":"-1.356499"},{"1":"2.33073","2":"-0.823889"},{"1":"2.90228","2":"-0.797982"},{"1":"3.50212","2":"-0.962570"},{"1":"5.42486","2":"-1.464843"},{"1":"3.58356","2":"-1.318911"},{"1":"4.57551","2":"-1.313113"},{"1":"3.64682","2":"-1.052166"},{"1":"4.08142","2":"-1.076782"},{"1":"3.84376","2":"-1.222161"},{"1":"4.95624","2":"-1.663320"},{"1":"1.44597","2":"0.497227"},{"1":"3.18115","2":"-0.641227"},{"1":"4.40182","2":"-1.791549"},{"1":"4.00218","2":"-0.759991"},{"1":"4.91994","2":"-0.795402"},{"1":"3.78366","2":"-1.260584"},{"1":"3.82146","2":"-0.428305"},{"1":"3.88886","2":"-1.984222"},{"1":"3.96289","2":"-1.866578"},{"1":"1.67115","2":"-0.499585"},{"1":"2.78415","2":"-0.234235"},{"1":"3.28514","2":"-1.172135"},{"1":"4.15392","2":"-1.333151"},{"1":"1.71371","2":"-0.469097"},{"1":"2.69299","2":"-0.418197"},{"1":"3.16214","2":"-0.767329"},{"1":"3.52290","2":"-0.558517"},{"1":"3.91316","2":"-1.757966"},{"1":"4.03262","2":"-1.183271"},{"1":"2.11855","2":"-0.304341"},{"1":"3.96217","2":"-0.861463"},{"1":"2.98301","2":"-0.304712"},{"1":"4.65976","2":"-1.470740"},{"1":"2.37058","2":"-1.123553"},{"1":"3.69275","2":"-0.785340"},{"1":"2.64734","2":"-0.632022"},{"1":"4.34224","2":"-1.592902"},{"1":"3.69723","2":"-1.136147"},{"1":"3.80590","2":"-1.112542"},{"1":"2.71085","2":"-0.941948"},{"1":"1.91043","2":"-0.018878"},{"1":"2.98097","2":"-0.796714"},{"1":"3.30484","2":"-0.696300"},{"1":"3.01910","2":"0.101515"},{"1":"4.08142","2":"-1.105878"},{"1":"1.32353","2":"-0.246931"},{"1":"3.82495","2":"-1.093369"},{"1":"2.53608","2":"-0.514266"},{"1":"2.31731","2":"-1.017761"},{"1":"3.70421","2":"-0.482133"},{"1":"3.59380","2":"-0.833221"},{"1":"3.18327","2":"-0.672701"},{"1":"3.57907","2":"-0.951075"},{"1":"2.65170","2":"-0.968527"},{"1":"2.49103","2":"-0.329026"},{"1":"3.67821","2":"-0.691794"},{"1":"2.49669","2":"-0.838641"},{"1":"2.86320","2":"-0.716712"},{"1":"4.12658","2":"-1.352658"},{"1":"4.13011","2":"-1.586550"},{"1":"4.94377","2":"-0.925922"},{"1":"4.52412","2":"-1.340527"},{"1":"1.78485","2":"-0.767665"},{"1":"3.75967","2":"-1.104453"},{"1":"2.25059","2":"-0.697859"},{"1":"7.86543","2":"-2.055371"},{"1":"4.65159","2":"-1.526419"},{"1":"3.72349","2":"-0.603035"},{"1":"3.35323","2":"-0.097767"},{"1":"3.55486","2":"-0.770961"},{"1":"3.56206","2":"-1.062756"},{"1":"4.17813","2":"-1.324884"},{"1":"3.20080","2":"-0.655854"},{"1":"5.08768","2":"-1.297391"},{"1":"4.46360","2":"-0.980902"},{"1":"3.87840","2":"-0.881768"},{"1":"3.02417","2":"-0.771162"},{"1":"1.90543","2":"-0.433555"},{"1":"3.30768","2":"-0.712943"},{"1":"3.52988","2":"-0.587880"},{"1":"3.23076","2":"-0.811103"},{"1":"1.72879","2":"-0.844632"},{"1":"5.77218","2":"-1.933805"},{"1":"2.95327","2":"-0.664748"},{"1":"2.51442","2":"-0.522306"},{"1":"3.85139","2":"-1.108763"},{"1":"4.05132","2":"-0.868018"},{"1":"3.97002","2":"-0.857347"},{"1":"3.91459","2":"-1.400132"},{"1":"3.44605","2":"-1.154582"},{"1":"3.58669","2":"-1.263405"},{"1":"4.21098","2":"-0.840103"},{"1":"2.34558","2":"-0.521200"},{"1":"4.72298","2":"-1.318068"},{"1":"3.41983","2":"-0.983481"},{"1":"3.75377","2":"-1.248410"},{"1":"4.62703","2":"-1.068991"},{"1":"4.63161","2":"-1.439347"},{"1":"3.26041","2":"-0.947125"},{"1":"2.98011","2":"-1.249985"},{"1":"2.51683","2":"-0.585066"},{"1":"3.56252","2":"-0.950854"},{"1":"4.34893","2":"-1.400141"},{"1":"5.75778","2":"-1.706860"},{"1":"3.87964","2":"-1.104462"},{"1":"4.06029","2":"-0.757549"},{"1":"3.10991","2":"-0.607882"},{"1":"3.66559","2":"-1.513641"},{"1":"2.20654","2":"-0.695711"},{"1":"3.13276","2":"-0.278024"},{"1":"4.12062","2":"-1.483777"},{"1":"3.56462","2":"-0.768673"},{"1":"4.55105","2":"-1.804899"},{"1":"3.71348","2":"-0.486742"},{"1":"2.77834","2":"-0.781253"},{"1":"2.04112","2":"-0.351766"},{"1":"2.91324","2":"-0.425558"},{"1":"3.23763","2":"-0.316664"},{"1":"2.86938","2":"-1.049098"},{"1":"3.61966","2":"-0.863841"},{"1":"4.09231","2":"-0.621646"},{"1":"4.16929","2":"-1.468339"},{"1":"3.58994","2":"-1.106306"},{"1":"3.24612","2":"-1.453701"},{"1":"3.82894","2":"-1.264409"},{"1":"4.29168","2":"-1.234512"},{"1":"4.17391","2":"-0.631833"},{"1":"3.39130","2":"-0.472386"},{"1":"4.34125","2":"-0.934127"},{"1":"4.59689","2":"-1.211827"},{"1":"3.21331","2":"-0.825899"},{"1":"4.98317","2":"-1.381701"},{"1":"3.13073","2":"-0.663382"},{"1":"4.17151","2":"-1.228492"},{"1":"3.22149","2":"-0.600936"},{"1":"3.03464","2":"-0.607667"},{"1":"2.26345","2":"-0.347717"},{"1":"2.16087","2":"-0.720828"},{"1":"3.42661","2":"-1.502331"},{"1":"3.26163","2":"-0.532578"},{"1":"3.06478","2":"-0.350553"},{"1":"5.11409","2":"-1.342184"},{"1":"2.59240","2":"-0.409418"},{"1":"3.91459","2":"-1.866593"},{"1":"3.43561","2":"-1.146663"},{"1":"4.25373","2":"-1.041952"},{"1":"2.40841","2":"-1.074550"},{"1":"2.41959","2":"-0.678319"},{"1":"3.34957","2":"-0.636169"},{"1":"2.17724","2":"-1.091193"},{"1":"2.59824","2":"-1.119915"},{"1":"4.61450","2":"-1.387116"},{"1":"2.81778","2":"-0.777479"},{"1":"3.89080","2":"-1.162954"},{"1":"3.88216","2":"-0.899435"},{"1":"1.50784","2":"0.068634"},{"1":"3.59543","2":"-1.117984"},{"1":"3.18655","2":"-0.854967"},{"1":"2.25917","2":"-1.152844"},{"1":"3.82200","2":"-1.157356"},{"1":"4.60497","2":"-1.651981"},{"1":"2.51947","2":"-1.227390"},{"1":"2.70197","2":"-0.816863"},{"1":"3.96421","2":"-1.157324"},{"1":"3.62216","2":"-1.114724"},{"1":"1.56966","2":"-0.608847"},{"1":"4.96710","2":"-2.022912"},{"1":"2.76628","2":"-0.943255"},{"1":"4.66754","2":"-2.346953"},{"1":"4.41873","2":"-1.341141"},{"1":"2.79208","2":"-0.179443"},{"1":"3.37349","2":"-0.684284"},{"1":"2.23260","2":"-0.012125"},{"1":"3.74429","2":"-0.965979"},{"1":"2.19138","2":"-1.350679"},{"1":"3.59671","2":"-0.910271"},{"1":"4.44546","2":"-1.178527"},{"1":"3.47238","2":"-0.826417"},{"1":"3.14498","2":"-0.687829"},{"1":"2.72885","2":"-1.058173"},{"1":"5.11451","2":"-2.313068"},{"1":"5.25816","2":"-1.165001"},{"1":"2.78792","2":"-0.205679"},{"1":"4.13985","2":"-1.368297"},{"1":"4.57143","2":"-1.685531"},{"1":"3.21481","2":"-0.793198"},{"1":"4.24232","2":"-1.703567"},{"1":"2.83527","2":"-0.642264"},{"1":"3.55842","2":"-1.042239"},{"1":"2.91025","2":"-0.785208"},{"1":"4.33826","2":"-1.266211"},{"1":"4.03589","2":"-1.542497"},{"1":"4.45848","2":"-1.018101"},{"1":"3.62876","2":"-1.042754"},{"1":"2.88598","2":"-0.832892"},{"1":"3.75464","2":"-1.106458"},{"1":"3.86741","2":"-1.287631"},{"1":"1.96061","2":"-0.670503"},{"1":"3.19794","2":"-0.941761"},{"1":"2.68255","2":"-0.992156"},{"1":"5.09353","2":"-1.322691"},{"1":"4.38057","2":"-1.340358"},{"1":"2.95005","2":"-0.830647"},{"1":"3.85575","2":"-1.545793"},{"1":"4.67837","2":"-1.432459"},{"1":"3.23069","2":"-0.665563"},{"1":"3.28300","2":"-1.189834"},{"1":"1.59795","2":"-0.446780"},{"1":"3.79602","2":"-1.376461"},{"1":"5.08874","2":"-1.428142"},{"1":"4.68262","2":"-1.519309"},{"1":"4.12207","2":"-1.421537"},{"1":"6.25794","2":"-1.306574"},{"1":"4.58275","2":"-1.825111"},{"1":"3.51477","2":"-1.073665"},{"1":"3.10613","2":"-1.290879"},{"1":"2.46989","2":"-0.527124"},{"1":"4.11808","2":"-1.268947"},{"1":"4.86947","2":"-1.685265"},{"1":"2.80353","2":"-0.509695"},{"1":"4.26231","2":"-1.445133"},{"1":"3.35014","2":"-0.959121"},{"1":"5.25812","2":"-1.362702"},{"1":"3.52338","2":"-0.460769"},{"1":"5.30463","2":"-1.111343"},{"1":"2.94629","2":"-0.168040"},{"1":"3.79752","2":"-1.428841"},{"1":"3.09407","2":"-1.119421"},{"1":"3.10822","2":"-0.656251"},{"1":"2.83765","2":"-0.614270"},{"1":"4.59563","2":"-1.569490"},{"1":"3.51931","2":"-0.492696"},{"1":"3.09423","2":"-0.908604"},{"1":"2.78967","2":"-0.637492"},{"1":"4.18668","2":"-0.595292"},{"1":"2.51831","2":"-0.405700"},{"1":"3.30136","2":"-1.039646"},{"1":"3.57090","2":"-0.576884"},{"1":"3.01559","2":"-0.266275"},{"1":"2.43063","2":"-0.477441"},{"1":"4.49010","2":"-1.621635"},{"1":"4.18891","2":"-0.708987"},{"1":"2.47046","2":"-1.143405"},{"1":"3.76906","2":"-1.261953"},{"1":"3.83144","2":"-0.699707"},{"1":"4.03150","2":"-1.582407"},{"1":"4.53779","2":"-1.405591"},{"1":"3.16505","2":"-1.187649"},{"1":"5.58941","2":"-2.381497"},{"1":"2.69282","2":"-0.516600"},{"1":"2.87087","2":"-0.921659"},{"1":"3.28355","2":"-0.895573"},{"1":"3.60063","2":"-1.670706"},{"1":"3.74038","2":"-0.720518"},{"1":"3.30717","2":"-1.725595"},{"1":"4.44324","2":"-1.293352"},{"1":"3.58381","2":"-1.027179"},{"1":"2.92493","2":"-0.608075"},{"1":"3.82303","2":"-1.328547"},{"1":"3.70779","2":"-0.989994"},{"1":"2.13276","2":"-0.166898"},{"1":"4.49908","2":"-1.390088"},{"1":"4.31632","2":"-1.967969"},{"1":"4.00807","2":"-0.633061"},{"1":"2.51588","2":"-0.797982"},{"1":"2.29812","2":"-0.305862"},{"1":"4.99259","2":"-1.910725"},{"1":"2.38778","2":"-0.462908"},{"1":"4.95214","2":"-1.485451"},{"1":"3.82450","2":"-1.370556"},{"1":"4.34143","2":"-0.965518"},{"1":"3.71646","2":"-1.503157"},{"1":"3.46171","2":"-1.321720"},{"1":"3.72410","2":"-1.643320"},{"1":"3.83452","2":"-1.072791"},{"1":"2.76093","2":"-0.636441"},{"1":"4.18350","2":"-1.165812"},{"1":"1.43198","2":"-0.431110"},{"1":"2.17794","2":"-0.903437"},{"1":"1.86656","2":"-0.445336"},{"1":"2.66245","2":"-0.582199"},{"1":"4.24737","2":"-1.493410"},{"1":"2.81202","2":"-1.309396"},{"1":"3.16519","2":"-1.144210"},{"1":"3.20411","2":"-0.973942"},{"1":"3.55217","2":"-1.067111"},{"1":"5.68240","2":"-1.943162"},{"1":"2.47655","2":"-0.302149"},{"1":"5.19801","2":"-2.042457"},{"1":"2.29979","2":"-0.434092"},{"1":"0.99040","2":"-0.073899"},{"1":"2.48341","2":"-0.396520"},{"1":"2.78885","2":"-0.761866"},{"1":"4.06096","2":"-1.408119"},{"1":"3.20582","2":"-1.452758"},{"1":"2.17323","2":"-0.912869"},{"1":"3.45826","2":"-0.184657"},{"1":"2.33385","2":"-0.718080"},{"1":"4.66399","2":"-0.888393"},{"1":"5.28370","2":"-1.516551"},{"1":"3.45083","2":"-1.375604"},{"1":"5.26505","2":"-1.764924"},{"1":"4.74360","2":"-1.491684"},{"1":"2.14691","2":"-0.579985"},{"1":"3.24407","2":"-0.650241"},{"1":"2.49470","2":"-0.007877"},{"1":"3.30907","2":"-1.536678"},{"1":"5.22503","2":"-1.494498"},{"1":"3.66720","2":"-0.922519"},{"1":"4.08897","2":"-0.946229"},{"1":"3.35393","2":"-1.152873"},{"1":"1.65265","2":"0.050987"},{"1":"3.00412","2":"-0.789721"},{"1":"2.98299","2":"-0.862313"},{"1":"2.84982","2":"-0.269104"},{"1":"5.80124","2":"-1.953595"},{"1":"2.84611","2":"-0.136535"},{"1":"2.91801","2":"-0.531227"},{"1":"2.45329","2":"-0.430671"},{"1":"3.95416","2":"-1.427182"},{"1":"2.46201","2":"-0.383336"},{"1":"3.08671","2":"-0.143121"},{"1":"2.90480","2":"-0.627247"},{"1":"3.10956","2":"-0.537911"},{"1":"4.42652","2":"-0.726098"},{"1":"2.67003","2":"-0.693789"},{"1":"3.34518","2":"-0.694310"},{"1":"3.35051","2":"-1.224701"},{"1":"2.31757","2":"-0.913698"},{"1":"4.16809","2":"-1.901346"},{"1":"3.67407","2":"-0.442326"},{"1":"3.17609","2":"-0.368115"},{"1":"2.57447","2":"-0.394578"},{"1":"3.78019","2":"-0.754847"},{"1":"2.87026","2":"-0.679645"},{"1":"1.12840","2":"-0.683743"},{"1":"3.19484","2":"-0.926283"},{"1":"4.59695","2":"-1.745898"},{"1":"4.51903","2":"-1.062537"},{"1":"4.06200","2":"-1.023199"},{"1":"2.26268","2":"-1.296338"},{"1":"3.60473","2":"-0.597897"},{"1":"4.26779","2":"-1.152875"},{"1":"2.77116","2":"-0.373886"},{"1":"3.34834","2":"-1.013455"},{"1":"4.22739","2":"-1.605233"},{"1":"3.23232","2":"-0.033929"},{"1":"3.40862","2":"-1.074608"},{"1":"2.09183","2":"-0.811252"},{"1":"4.01093","2":"-1.697833"},{"1":"2.97221","2":"-0.204907"},{"1":"3.08391","2":"-0.851497"},{"1":"4.84971","2":"-1.302428"},{"1":"3.75074","2":"-1.145484"},{"1":"4.12431","2":"-1.437214"},{"1":"3.14802","2":"-1.398780"},{"1":"3.75035","2":"-1.157699"},{"1":"1.99157","2":"-0.600786"},{"1":"3.53210","2":"-1.247132"},{"1":"3.11791","2":"-0.637754"},{"1":"1.57854","2":"-0.522311"},{"1":"1.38027","2":"-0.289279"},{"1":"3.60193","2":"-1.101021"},{"1":"3.29883","2":"-1.207613"},{"1":"2.61370","2":"-0.122155"},{"1":"3.54934","2":"-0.474366"},{"1":"2.36693","2":"-0.373737"},{"1":"3.26533","2":"-0.971510"},{"1":"4.44477","2":"-1.623438"},{"1":"4.00167","2":"-1.731461"},{"1":"3.58141","2":"-1.390899"},{"1":"3.96459","2":"-1.094524"},{"1":"3.77217","2":"-0.527207"},{"1":"2.88111","2":"-0.166179"},{"1":"2.87920","2":"-0.932629"},{"1":"3.74399","2":"-0.953087"},{"1":"4.98202","2":"-1.661511"},{"1":"4.76406","2":"-1.641200"},{"1":"4.41597","2":"-1.289842"},{"1":"3.66316","2":"-0.908078"},{"1":"3.06128","2":"-1.140660"},{"1":"1.46375","2":"-1.076055"},{"1":"2.68339","2":"-0.859591"},{"1":"3.82974","2":"-1.090326"},{"1":"2.17051","2":"-0.419513"},{"1":"3.18868","2":"-0.634826"},{"1":"3.72656","2":"-1.598771"},{"1":"3.79258","2":"-1.407162"},{"1":"3.99890","2":"-0.770142"},{"1":"4.08689","2":"-0.878635"},{"1":"2.73791","2":"-1.010629"},{"1":"3.53728","2":"-1.252675"},{"1":"3.33147","2":"-0.815909"},{"1":"4.34465","2":"-1.947446"},{"1":"3.80176","2":"-1.808313"},{"1":"4.99200","2":"-1.704908"},{"1":"3.64859","2":"-0.742763"},{"1":"2.93316","2":"-0.882813"},{"1":"5.48732","2":"-2.209460"},{"1":"3.67177","2":"-1.222019"},{"1":"2.90250","2":"-0.949791"},{"1":"4.46882","2":"-0.896754"},{"1":"2.71286","2":"-0.757441"},{"1":"3.38224","2":"-0.835479"},{"1":"3.02184","2":"-0.835781"},{"1":"3.20858","2":"-0.307990"},{"1":"4.50112","2":"-0.834613"},{"1":"5.63838","2":"-1.674963"},{"1":"2.54791","2":"-0.739850"},{"1":"3.17944","2":"-0.590885"},{"1":"3.68406","2":"-0.704059"},{"1":"3.50423","2":"-0.436351"},{"1":"4.22021","2":"-1.411553"},{"1":"3.39277","2":"-0.703108"},{"1":"4.13687","2":"-0.391720"},{"1":"2.37477","2":"-0.577741"},{"1":"3.25923","2":"-1.474558"},{"1":"2.82322","2":"-0.794864"},{"1":"4.74931","2":"-1.354457"},{"1":"3.54093","2":"-2.032990"},{"1":"5.66604","2":"-2.061305"},{"1":"3.32943","2":"-0.866403"},{"1":"3.14269","2":"-1.182026"},{"1":"3.28526","2":"-0.810776"},{"1":"3.90010","2":"-0.792777"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb611-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb611-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> group_a)) <span class="op">+</span></a>
<a class="sourceLine" id="cb611-3" title="3"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, </a>
<a class="sourceLine" id="cb611-4" title="4">               <span class="dt">fill =</span> <span class="st">&quot;dodgerblue3&quot;</span>, </a>
<a class="sourceLine" id="cb611-5" title="5">               <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb611-6" title="6"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </a>
<a class="sourceLine" id="cb611-7" title="7">                <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="fl">3.5</span>, <span class="dt">sd =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb611-8" title="8">                <span class="dt">linetype =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb611-9" title="9">                ) </a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-529-1.png" width="576" /></p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb612-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb612-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> group_b)) <span class="op">+</span></a>
<a class="sourceLine" id="cb612-3" title="3"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, </a>
<a class="sourceLine" id="cb612-4" title="4">               <span class="dt">fill =</span> <span class="st">&quot;dodgerblue3&quot;</span>, </a>
<a class="sourceLine" id="cb612-5" title="5">               <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb612-6" title="6"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, </a>
<a class="sourceLine" id="cb612-7" title="7">                <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="dv">-1</span>, <span class="dt">sd =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb612-8" title="8">                <span class="dt">linetype =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb612-9" title="9">                ) </a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-530-1.png" width="576" /></p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb613-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb613-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> group_a, <span class="dt">y =</span> group_b)) <span class="op">+</span></a>
<a class="sourceLine" id="cb613-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb613-4" title="4"><span class="st">  </span><span class="kw">stat_ellipse</span>(<span class="dt">type =</span> <span class="st">&quot;norm&quot;</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-531-1.png" width="576" /></p>
<p>我们回头验算一下</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb614-1" title="1">d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(</a>
<a class="sourceLine" id="cb614-2" title="2">  <span class="dt">a_mean =</span> <span class="kw">mean</span>(group_a),</a>
<a class="sourceLine" id="cb614-3" title="3">  <span class="dt">b_mean =</span> <span class="kw">mean</span>(group_b),</a>
<a class="sourceLine" id="cb614-4" title="4">  <span class="dt">a_sd =</span> <span class="kw">sd</span>(group_a),</a>
<a class="sourceLine" id="cb614-5" title="5">  <span class="dt">b_sd =</span> <span class="kw">sd</span>(group_b),</a>
<a class="sourceLine" id="cb614-6" title="6">  <span class="dt">cor =</span> <span class="kw">cor</span>(group_a,group_b),</a>
<a class="sourceLine" id="cb614-7" title="7">  <span class="dt">cov =</span> <span class="kw">cov</span>(group_a,group_b)</a>
<a class="sourceLine" id="cb614-8" title="8">  )</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["a_mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["b_mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["a_sd"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["b_sd"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["cor"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["cov"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"3.52","2":"-1.004","3":"0.974","4":"0.4922","5":"-0.6941","6":"-0.3328"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div id="section-117" class="section level2">
<h2><span class="header-section-number">13.3</span> 蒙特卡洛</h2>
<p>这是我研究生时候老师布置的一个的题目，当时我用的是C语言代码，现在我们有强大的tidyverse</p>
<p><img src="images/pi.jpg" width="50%" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb615-1" title="1"><span class="kw">set.seed</span>(<span class="dv">2019</span>)</a>
<a class="sourceLine" id="cb615-2" title="2"></a>
<a class="sourceLine" id="cb615-3" title="3">n &lt;-<span class="st"> </span><span class="dv">50000</span></a>
<a class="sourceLine" id="cb615-4" title="4">points &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">&quot;x&quot;</span> =<span class="st"> </span><span class="kw">runif</span>(n), <span class="st">&quot;y&quot;</span> =<span class="st"> </span><span class="kw">runif</span>(n))</a></code></pre></div>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" title="1">points &lt;-<span class="st"> </span>points <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb616-2" title="2"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">inside =</span> <span class="kw">map2_dbl</span>(<span class="dt">.x =</span> x, <span class="dt">.y =</span> y, <span class="op">~</span><span class="kw">if_else</span>(.x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>.y<span class="op">**</span><span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb616-3" title="3"><span class="st">    </span><span class="kw">rowid_to_column</span>(<span class="st">&quot;N&quot;</span>)</a></code></pre></div>
<p>正方形的面积是1，圆的面积是<span class="math inline">\(\pi r^2 = \frac{1}{4} \pi\)</span>，如果知道两者的比例，就可以估算<span class="math inline">\(\pi\)</span></p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb617-1" title="1">points &lt;-<span class="st"> </span>points <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb617-2" title="2"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">estimate =</span> <span class="dv">4</span><span class="op">*</span><span class="kw">cumsum</span>(inside)<span class="op">/</span>N)</a></code></pre></div>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb618-1" title="1">points <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tail</span>()</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["N"],"name":[1],"type":["int"],"align":["right"]},{"label":["x"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["inside"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["estimate"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"49995","2":"0.590941","3":"0.04113","4":"1","5":"3.154"},{"1":"49996","2":"0.944844","3":"0.12664","4":"1","5":"3.154"},{"1":"49997","2":"0.653940","3":"0.15856","4":"1","5":"3.155"},{"1":"49998","2":"0.521017","3":"0.49110","4":"1","5":"3.155"},{"1":"49999","2":"0.811726","3":"0.20315","4":"1","5":"3.155"},{"1":"50000","2":"0.009348","3":"0.65669","4":"1","5":"3.155"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb619-1" title="1">points <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb619-2" title="2"><span class="st">    </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb619-3" title="3"><span class="st">    </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> estimate, <span class="dt">x =</span> N), <span class="dt">colour =</span> <span class="st">&quot;#82518c&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb619-4" title="4"><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> pi) </a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-538-1.png" width="576" /></p>
</div>
<div id="section-118" class="section level2">
<h2><span class="header-section-number">13.4</span> 抽样与样本</h2>
<div id="section-119" class="section level3">
<h3><span class="header-section-number">13.4.1</span> 总体分布</h3>
<p>假定一个事实，川师男生总体的平均身高和身高的标准差分别为</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" title="1">true.mean &lt;-<span class="st"> </span><span class="fl">175.7</span></a>
<a class="sourceLine" id="cb620-2" title="2">true.sd &lt;-<span class="st"> </span><span class="fl">15.19</span></a></code></pre></div>
<p>那么我们可以模拟分布情况如下</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb621-1" title="1">pop.distn &lt;-</a>
<a class="sourceLine" id="cb621-2" title="2"><span class="st">  </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb621-3" title="3">    <span class="dt">height =</span> <span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">250</span>, <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb621-4" title="4">    <span class="dt">density =</span> <span class="kw">dnorm</span>(height, <span class="dt">mean =</span> true.mean, <span class="dt">sd =</span> true.sd)</a>
<a class="sourceLine" id="cb621-5" title="5">  )</a>
<a class="sourceLine" id="cb621-6" title="6"></a>
<a class="sourceLine" id="cb621-7" title="7"><span class="kw">ggplot</span>(pop.distn) <span class="op">+</span></a>
<a class="sourceLine" id="cb621-8" title="8"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(height, density)) <span class="op">+</span></a>
<a class="sourceLine" id="cb621-9" title="9"><span class="st">  </span><span class="kw">geom_vline</span>(</a>
<a class="sourceLine" id="cb621-10" title="10">    <span class="dt">xintercept =</span> true.mean,</a>
<a class="sourceLine" id="cb621-11" title="11">    <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb621-12" title="12">    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span></a>
<a class="sourceLine" id="cb621-13" title="13">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb621-14" title="14"><span class="st">  </span><span class="kw">geom_vline</span>(</a>
<a class="sourceLine" id="cb621-15" title="15">    <span class="dt">xintercept =</span> true.mean <span class="op">+</span><span class="st"> </span>true.sd,</a>
<a class="sourceLine" id="cb621-16" title="16">    <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb621-17" title="17">    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span></a>
<a class="sourceLine" id="cb621-18" title="18">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb621-19" title="19"><span class="st">  </span><span class="kw">geom_vline</span>(</a>
<a class="sourceLine" id="cb621-20" title="20">    <span class="dt">xintercept =</span> true.mean <span class="op">-</span><span class="st"> </span>true.sd,</a>
<a class="sourceLine" id="cb621-21" title="21">    <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb621-22" title="22">    <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span></a>
<a class="sourceLine" id="cb621-23" title="23">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb621-24" title="24"><span class="st">  </span><span class="kw">labs</span>(</a>
<a class="sourceLine" id="cb621-25" title="25">    <span class="dt">x =</span> <span class="st">&quot;Height (cm)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Density&quot;</span>,</a>
<a class="sourceLine" id="cb621-26" title="26">    <span class="dt">title =</span> <span class="st">&quot;川师男生身高分布&quot;</span></a>
<a class="sourceLine" id="cb621-27" title="27">  )</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-540-1.png" width="576" /></p>
</div>
<div id="section-120" class="section level3">
<h3><span class="header-section-number">13.4.2</span> 样本</h3>
<p>假定我们从中抽取30个男生身高样本</p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" title="1">sample.a &lt;-</a>
<a class="sourceLine" id="cb622-2" title="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">height =</span> <span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">30</span>, <span class="dt">mean =</span> true.mean, <span class="dt">sd =</span> true.sd))</a></code></pre></div>
<p>然后看看样本的直方图</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb623-1" title="1">sample.a <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb623-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height)) <span class="op">+</span></a>
<a class="sourceLine" id="cb623-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)),</a>
<a class="sourceLine" id="cb623-4" title="4">    <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>,</a>
<a class="sourceLine" id="cb623-5" title="5">    <span class="dt">alpha =</span> <span class="fl">0.75</span>,</a>
<a class="sourceLine" id="cb623-6" title="6">    <span class="dt">bins =</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb623-7" title="7">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb623-8" title="8"><span class="st">  </span><span class="kw">geom_line</span>(</a>
<a class="sourceLine" id="cb623-9" title="9">    <span class="dt">data =</span> pop.distn,</a>
<a class="sourceLine" id="cb623-10" title="10">    <span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> density),</a>
<a class="sourceLine" id="cb623-11" title="11">    <span class="dt">alpha =</span> <span class="fl">0.25</span>, <span class="dt">size =</span> <span class="fl">1.5</span></a>
<a class="sourceLine" id="cb623-12" title="12">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb623-13" title="13"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> true.mean, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb623-14" title="14"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">mean</span>(sample.a<span class="op">$</span>height), <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>)</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-542-1.png" width="576" /></p>
<p>红色的虚线代表分布的总体的均值，黑色实线代表30个样本的均值，</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb624-1" title="1">sample.a <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb624-2" title="2"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb624-3" title="3">    <span class="dt">sample.mean =</span> <span class="kw">mean</span>(height),</a>
<a class="sourceLine" id="cb624-4" title="4">    <span class="dt">sample.sd =</span> <span class="kw">sd</span>(height)</a>
<a class="sourceLine" id="cb624-5" title="5">  )</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sample.mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sample.sd"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"175.7","2":"17.3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>也就是说，基于这30个观察值的样本，我们认为川师男生的身高均值为175.743cm，方差为17.3027</p>
<p>可能有同学说，这个样本太少了，计算的均值还不够科学，会以偏概全。于是又重新找了30个男生，和上次类似，用<code>rnorm</code>函数模拟，我们记为样本b</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb625-1" title="1">sample.b &lt;-</a>
<a class="sourceLine" id="cb625-2" title="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">height =</span> <span class="kw">rnorm</span>(<span class="dv">30</span>, <span class="dt">mean =</span> true.mean, <span class="dt">sd =</span> true.sd))</a></code></pre></div>
<p>再来看看这次样本的分布</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb626-1" title="1">sample.b <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb626-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> height)) <span class="op">+</span></a>
<a class="sourceLine" id="cb626-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)),</a>
<a class="sourceLine" id="cb626-4" title="4">    <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.75</span>, <span class="dt">bins =</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb626-5" title="5">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb626-6" title="6"><span class="st">  </span><span class="kw">geom_line</span>(</a>
<a class="sourceLine" id="cb626-7" title="7">    <span class="dt">data =</span> pop.distn, <span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> density),</a>
<a class="sourceLine" id="cb626-8" title="8">    <span class="dt">alpha =</span> <span class="fl">0.25</span>, <span class="dt">size =</span> <span class="fl">1.5</span></a>
<a class="sourceLine" id="cb626-9" title="9">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb626-10" title="10"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> true.mean, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb626-11" title="11"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">mean</span>(sample.a<span class="op">$</span>height), <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>)</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-545-1.png" width="576" /></p>
<p>同样，我们计算样本b的均值和方差</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb627-1" title="1">sample.b <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb627-2" title="2"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb627-3" title="3">    <span class="dt">sample.mean =</span> <span class="kw">mean</span>(height),</a>
<a class="sourceLine" id="cb627-4" title="4">    <span class="dt">sample.sd =</span> <span class="kw">sd</span>(height)</a>
<a class="sourceLine" id="cb627-5" title="5">  )</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sample.mean"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sample.sd"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"173.7","2":"14.86"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>这次抽样的结果，均值为173.711cm，方差为14.8641</p>
<p>和样本a比，有一点点变化。不经想问，我能否继续抽样呢？结果会有变化吗？为了避免重复写代码
，我把上面的过程整合到一起，写一个<strong>子函数</strong>，专门模拟抽样过程</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb628-1" title="1">rnorm.stats &lt;-<span class="st"> </span><span class="cf">function</span>(n, mu, sigma) {</a>
<a class="sourceLine" id="cb628-2" title="2">  the.sample &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mu, sigma)</a>
<a class="sourceLine" id="cb628-3" title="3">  <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb628-4" title="4">    <span class="dt">sample.size =</span> n,</a>
<a class="sourceLine" id="cb628-5" title="5">    <span class="dt">sample.mean =</span> <span class="kw">mean</span>(the.sample),</a>
<a class="sourceLine" id="cb628-6" title="6">    <span class="dt">sample.sd =</span> <span class="kw">sd</span>(the.sample)</a>
<a class="sourceLine" id="cb628-7" title="7">  )</a>
<a class="sourceLine" id="cb628-8" title="8">}</a></code></pre></div>
<p>于是，我们又可以继续模拟了。注意我们之前设定的总体分布的均值和方差</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb629-1" title="1">true.mean &lt;-<span class="st"> </span><span class="fl">175.7</span></a>
<a class="sourceLine" id="cb629-2" title="2">true.sd &lt;-<span class="st"> </span><span class="fl">15.19</span></a></code></pre></div>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb630-1" title="1"><span class="kw">rnorm.stats</span>(<span class="dv">30</span>, true.mean, true.sd)</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sample.size"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sample.mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sample.sd"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"30","2":"175.3","3":"16.23"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>yes，代码工作的很好，但不过只是代码减少了一点点，仍然只是一次抽样（这里30个样本为一次抽样），<strong>我们的目的是反复抽样</strong>， 抽很多次的那种喔。</p>
<p>那我们用<code>purrr</code>包的<code>rerun</code>函数偷个懒，</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb631-1" title="1">df.samples.of<span class="fl">.30</span> &lt;-</a>
<a class="sourceLine" id="cb631-2" title="2"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">rerun</span>(<span class="dv">2500</span>, <span class="kw">rnorm.stats</span>(<span class="dv">30</span>, true.mean, true.sd)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb631-3" title="3"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>()</a></code></pre></div>
<p>哇，一下子抽了2500个样本,全部装进了<code>df.sample.of.30</code>这个数据框， 偷偷看一眼呢</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb632-1" title="1">df.samples.of<span class="fl">.30</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sample.size"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sample.mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sample.sd"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"30","2":"173.0","3":"16.06"},{"1":"30","2":"177.5","3":"15.81"},{"1":"30","2":"175.3","3":"14.18"},{"1":"30","2":"178.9","3":"17.89"},{"1":"30","2":"178.0","3":"15.41"},{"1":"30","2":"180.3","3":"12.63"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>回过头看看<code>df.samples.of.30</code>是什么：</p>
<ul>
<li>从川师的男生中随机抽取30个，计算这30个人身高的均值和方差，这叫一次抽样</li>
<li>把上面的工作，重复2500次，得到2500个均值和方差</li>
<li>2500个均值和方差，组成了一个数据框</li>
</ul>
<p>我们发现每次抽样的均值都不一样，感觉又像一个分布(抽样的均值分布)，我们画出来看看吧</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb633-1" title="1">df.samples.of<span class="fl">.30</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb633-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sample.mean, <span class="dt">y =</span> <span class="kw">stat</span>(density))) <span class="op">+</span></a>
<a class="sourceLine" id="cb633-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">25</span>, <span class="dt">fill =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb633-4" title="4"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> true.mean, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb633-5" title="5"><span class="st">  </span><span class="kw">labs</span>(</a>
<a class="sourceLine" id="cb633-6" title="6">    <span class="dt">title =</span> <span class="st">&quot;抽样2500次（每次30个男生）身高均值的分布&quot;</span>,</a>
<a class="sourceLine" id="cb633-7" title="7">    <span class="dt">subtitle =</span> <span class="st">&quot;Distribution of mean heights for 2500 samples of size 30&quot;</span></a>
<a class="sourceLine" id="cb633-8" title="8">  )</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-552-1.png" width="576" />
注意到，这不是男生身高的分布，而是<strong>每次抽样计算的均值</strong>构成的分布.</p>
<p>为了更清楚的说明，我们把<strong>整体的分布(灰色曲线)、样本a（蓝色直方图）、抽样的均值分布（红色直方图）</strong>三者画在一起。</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb634-1" title="1">df.samples.of<span class="fl">.30</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb634-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sample.mean, <span class="dt">y =</span> <span class="kw">stat</span>(density))) <span class="op">+</span></a>
<a class="sourceLine" id="cb634-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">50</span>, <span class="dt">fill =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb634-4" title="4"><span class="st">  </span><span class="kw">geom_histogram</span>(</a>
<a class="sourceLine" id="cb634-5" title="5">    <span class="dt">data =</span> sample.a,</a>
<a class="sourceLine" id="cb634-6" title="6">    <span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> <span class="kw">stat</span>(density)),</a>
<a class="sourceLine" id="cb634-7" title="7">    <span class="dt">bins =</span> <span class="dv">11</span>, <span class="dt">fill =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.25</span></a>
<a class="sourceLine" id="cb634-8" title="8">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb634-9" title="9"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> true.mean, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb634-10" title="10"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> pop.distn, <span class="kw">aes</span>(<span class="dt">x =</span> height, <span class="dt">y =</span> density), <span class="dt">alpha =</span> <span class="fl">0.25</span>, <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb634-11" title="11"><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">125</span>, <span class="dv">225</span>)</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-553-1.png" width="576" /></p>
<p>样本的均值分布，是个很有意思的结果，比如，我们<strong>再选30个男生</strong>再抽样一次，我们可以断定，这次抽样的均值会落在了红色的区间之内。</p>
<p>然而，注意到，必须限定再次抽样的大小仍然是30个男生，以上这句话才成立。</p>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb635-1" title="1">df.samples.of<span class="fl">.30</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb635-2" title="2"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb635-3" title="3">    <span class="dt">mean.of.means =</span> <span class="kw">mean</span>(sample.mean),</a>
<a class="sourceLine" id="cb635-4" title="4">    <span class="dt">sd.of.means =</span> <span class="kw">sd</span>(sample.mean)</a>
<a class="sourceLine" id="cb635-5" title="5">  )</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["mean.of.means"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["sd.of.means"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"175.7","2":"2.769"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>这里计算的是抽样(样本大小为30)均值分布，而不是整体的均值分布。言外之意，样本大小可以是其它的呗， 那就把样本调整为50、100、250、500分别试试看</p>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb636-1" title="1">df.samples.of<span class="fl">.50</span> &lt;-</a>
<a class="sourceLine" id="cb636-2" title="2"><span class="st">  </span><span class="kw">rerun</span>(<span class="dv">2500</span>, <span class="kw">rnorm.stats</span>(<span class="dv">50</span>, true.mean, true.sd)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb636-3" title="3"><span class="st">  </span><span class="kw">bind_rows</span>()</a>
<a class="sourceLine" id="cb636-4" title="4"></a>
<a class="sourceLine" id="cb636-5" title="5">df.samples.of<span class="fl">.100</span> &lt;-</a>
<a class="sourceLine" id="cb636-6" title="6"><span class="st">  </span><span class="kw">rerun</span>(<span class="dv">2500</span>, <span class="kw">rnorm.stats</span>(<span class="dv">100</span>, true.mean, true.sd)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb636-7" title="7"><span class="st">  </span><span class="kw">bind_rows</span>()</a>
<a class="sourceLine" id="cb636-8" title="8"></a>
<a class="sourceLine" id="cb636-9" title="9">df.samples.of<span class="fl">.250</span> &lt;-</a>
<a class="sourceLine" id="cb636-10" title="10"><span class="st">  </span><span class="kw">rerun</span>(<span class="dv">2500</span>, <span class="kw">rnorm.stats</span>(<span class="dv">250</span>, true.mean, true.sd)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb636-11" title="11"><span class="st">  </span><span class="kw">bind_rows</span>()</a>
<a class="sourceLine" id="cb636-12" title="12"></a>
<a class="sourceLine" id="cb636-13" title="13">df.samples.of<span class="fl">.500</span> &lt;-</a>
<a class="sourceLine" id="cb636-14" title="14"><span class="st">  </span><span class="kw">rerun</span>(<span class="dv">2500</span>, <span class="kw">rnorm.stats</span>(<span class="dv">500</span>, true.mean, true.sd)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb636-15" title="15"><span class="st">  </span><span class="kw">bind_rows</span>()</a></code></pre></div>
<p>忍不住想画图看看，每次抽取的男生数量不同，均值的分布会有不同？</p>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb637-1" title="1">df.combined &lt;-</a>
<a class="sourceLine" id="cb637-2" title="2"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb637-3" title="3">    df.samples.of<span class="fl">.30</span>,</a>
<a class="sourceLine" id="cb637-4" title="4">    df.samples.of<span class="fl">.50</span>,</a>
<a class="sourceLine" id="cb637-5" title="5">    df.samples.of<span class="fl">.100</span>,</a>
<a class="sourceLine" id="cb637-6" title="6">    df.samples.of<span class="fl">.250</span>,</a>
<a class="sourceLine" id="cb637-7" title="7">    df.samples.of<span class="fl">.500</span></a>
<a class="sourceLine" id="cb637-8" title="8">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb637-9" title="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample.sz =</span> <span class="kw">as.factor</span>(sample.size))</a></code></pre></div>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb638-1" title="1">df.combined <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb638-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sample.mean, <span class="dt">y =</span> <span class="kw">stat</span>(density), <span class="dt">fill =</span> sample.sz)) <span class="op">+</span></a>
<a class="sourceLine" id="cb638-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">25</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb638-4" title="4"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> true.mean, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb638-5" title="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="kw">vars</span>(sample.sz), <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb638-6" title="6"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb638-7" title="7"><span class="st">  </span><span class="kw">labs</span>(</a>
<a class="sourceLine" id="cb638-8" title="8">    <span class="dt">x =</span> <span class="st">&quot;Sample means&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Density&quot;</span>,</a>
<a class="sourceLine" id="cb638-9" title="9">    <span class="dt">title =</span> <span class="st">&quot;Distribution of mean heights for samples of varying size&quot;</span></a>
<a class="sourceLine" id="cb638-10" title="10">  )</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-557-1.png" width="960" /></p>
<p>随着样本大小由30增加到500，抽样的均值分布围绕着越来越聚合到实际的均值，或者说随着样本大小的增多，对均值估计的不确定性越小。</p>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb639-1" title="1">sampling.distn.mean.table &lt;-</a>
<a class="sourceLine" id="cb639-2" title="2"><span class="st">  </span>df.combined <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb639-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(sample.size) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb639-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb639-5" title="5">    <span class="dt">mean.of.means =</span> <span class="kw">mean</span>(sample.mean),</a>
<a class="sourceLine" id="cb639-6" title="6">    <span class="dt">sd.of.means =</span> <span class="kw">sd</span>(sample.mean)</a>
<a class="sourceLine" id="cb639-7" title="7">  )</a>
<a class="sourceLine" id="cb639-8" title="8">sampling.distn.mean.table</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sample.size"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["mean.of.means"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd.of.means"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"30","2":"175.7","3":"2.7690"},{"1":"50","2":"175.7","3":"2.1111"},{"1":"100","2":"175.7","3":"1.5137"},{"1":"250","2":"175.7","3":"0.9478"},{"1":"500","2":"175.7","3":"0.6715"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>有个统计学上的概念需要明确。</p>
<p>输出结果的第三列<code>sd.of.means</code> 是不同样本大小(30,50,100,250,500)下，反复抽样后平均数分布的标准差。</p>
<p>数学上，如果已知总体的标准差(<span class="math inline">\(\sigma\)</span>)，那么抽取无限多份大小为 <span class="math inline">\(n\)</span> 的样本，每个样本各有一个平均值，所有这个大小的样本之平均值的标准差可证明为</p>
<p><span class="math display">\[
\frac{\sigma}{\sqrt{n}}
\]</span>
即，<strong>平均值的标准误差</strong>。</p>
<p>下面我们画图看看，模拟出来的<span class="math inline">\(sd.of.means\)</span>和理论值<span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span>是否一致。</p>
<p>注意到这里的<span class="math inline">\(\sigma\)</span>是总体的标准差，即最开始我们设定的川师男生身高的标准差<code>true.sd</code>. 也就说，理论上</p>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb640-1" title="1">df.se.mean.theory &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb640-2" title="2">  <span class="dt">sample.size =</span> <span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">500</span>,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb640-3" title="3">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb640-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">std.error =</span> true.sd<span class="op">/</span><span class="kw">sqrt</span>(sample.size))</a>
<a class="sourceLine" id="cb640-5" title="5"></a>
<a class="sourceLine" id="cb640-6" title="6">df.se.mean.theory</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sample.size"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"10","2":"4.8035"},{"1":"20","2":"3.3966"},{"1":"30","2":"2.7733"},{"1":"40","2":"2.4017"},{"1":"50","2":"2.1482"},{"1":"60","2":"1.9610"},{"1":"70","2":"1.8156"},{"1":"80","2":"1.6983"},{"1":"90","2":"1.6012"},{"1":"100","2":"1.5190"},{"1":"110","2":"1.4483"},{"1":"120","2":"1.3867"},{"1":"130","2":"1.3323"},{"1":"140","2":"1.2838"},{"1":"150","2":"1.2403"},{"1":"160","2":"1.2009"},{"1":"170","2":"1.1650"},{"1":"180","2":"1.1322"},{"1":"190","2":"1.1020"},{"1":"200","2":"1.0741"},{"1":"210","2":"1.0482"},{"1":"220","2":"1.0241"},{"1":"230","2":"1.0016"},{"1":"240","2":"0.9805"},{"1":"250","2":"0.9607"},{"1":"260","2":"0.9420"},{"1":"270","2":"0.9244"},{"1":"280","2":"0.9078"},{"1":"290","2":"0.8920"},{"1":"300","2":"0.8770"},{"1":"310","2":"0.8627"},{"1":"320","2":"0.8491"},{"1":"330","2":"0.8362"},{"1":"340","2":"0.8238"},{"1":"350","2":"0.8119"},{"1":"360","2":"0.8006"},{"1":"370","2":"0.7897"},{"1":"380","2":"0.7792"},{"1":"390","2":"0.7692"},{"1":"400","2":"0.7595"},{"1":"410","2":"0.7502"},{"1":"420","2":"0.7412"},{"1":"430","2":"0.7325"},{"1":"440","2":"0.7242"},{"1":"450","2":"0.7161"},{"1":"460","2":"0.7082"},{"1":"470","2":"0.7007"},{"1":"480","2":"0.6933"},{"1":"490","2":"0.6862"},{"1":"500","2":"0.6793"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb641-1" title="1">sampling.distn.mean.table <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb641-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sample.size, <span class="dt">y =</span> sd.of.means)) <span class="op">+</span></a>
<a class="sourceLine" id="cb641-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb641-4" title="4"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sample.size, <span class="dt">y =</span> std.error), </a>
<a class="sourceLine" id="cb641-5" title="5">            <span class="dt">data =</span> df.se.mean.theory, </a>
<a class="sourceLine" id="cb641-6" title="6">            <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb641-7" title="7"><span class="st">  </span><span class="kw">labs</span>(</a>
<a class="sourceLine" id="cb641-8" title="8">    <span class="dt">x =</span> <span class="st">&quot;Sample size&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Std Error of Mean&quot;</span>,</a>
<a class="sourceLine" id="cb641-9" title="9">    <span class="dt">title =</span> <span class="st">&quot;平均值标准误差随样本大小变化（理论值和模拟值对比）&quot;</span></a>
<a class="sourceLine" id="cb641-10" title="10">  )</a></code></pre></div>
<p><img src="R4DS_files/figure-html/unnamed-chunk-560-1.png" width="576" /></p>
<p>两者吻合的很好。</p>
<p>刚刚我们看到的，<strong>抽样均值分布</strong>随着<strong>样本大小</strong>变化而变化。可以试想下，抽样的其他统计量分布（方差，中位数），是不是也随着样本大小变化而变化呢？</p>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb642-1" title="1">sampling.distn.sd.table &lt;-</a>
<a class="sourceLine" id="cb642-2" title="2"><span class="st">  </span>df.combined <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb642-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(sample.size) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb642-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb642-5" title="5">    <span class="dt">mean.of.sds =</span> <span class="kw">mean</span>(sample.sd),</a>
<a class="sourceLine" id="cb642-6" title="6">    <span class="dt">sd.of.sds =</span> <span class="kw">sd</span>(sample.sd)</a>
<a class="sourceLine" id="cb642-7" title="7">  )</a>
<a class="sourceLine" id="cb642-8" title="8"></a>
<a class="sourceLine" id="cb642-9" title="9">sampling.distn.sd.table</a></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sample.size"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["mean.of.sds"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sd.of.sds"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"30","2":"15.12","3":"1.9942"},{"1":"50","2":"15.14","3":"1.5600"},{"1":"100","2":"15.19","3":"1.0706"},{"1":"250","2":"15.18","3":"0.6807"},{"1":"500","2":"15.17","3":"0.4856"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>答案是肯定的，样本量的增多，抽样方差的不确定性减少。</p>
</div>
</div>
<div id="section-121" class="section level2">
<h2><span class="header-section-number">13.5</span> 扩展阅读</h2>
<ul>
<li><a href="https://learningstatisticswithr.com/book/" class="uri">https://learningstatisticswithr.com/book/</a></li>
</ul>
<!-- - <https://bookdown.org/content/922/> -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tibble.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidystats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/yihui/bookdown-chinese/edit/master/sampling.Rmd",
"text": "编辑"
},
"history": {
"link": null,
"text": null
},
"download": ["R4DS.pdf", "R4DS.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
